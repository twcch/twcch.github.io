document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".table-of-contents"),o=document.querySelector(".post__content");if(!e||!o)return;e.closest(".post__content")&&(document.body.appendChild(e),e.classList.add("floating-toc"));const t=document.createElement("button");t.className="table-of-contents__toggle",t.innerHTML="−",t.setAttribute("aria-label","摺疊目錄"),e.appendChild(t);let n=!1;t.addEventListener("click",function(){n=!n,e.classList.toggle("minimized",n),t.innerHTML=n?"+":"−",t.setAttribute("aria-label",n?"展開目錄":"摺疊目錄")});const c=o.querySelectorAll("h1, h2, h3, h4, h5, h6"),i=e.querySelectorAll('a[href^="#"]');function a(){let t="";const n=window.pageYOffset;if(c.forEach(e=>{const n=e.getBoundingClientRect();n.top<=100&&(t=e.id)}),i.forEach(e=>e.classList.remove("active")),t){const n=e.querySelector(`a[href="#${t}"]`);n&&n.classList.add("active")}}i.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const n=this.getAttribute("href").substring(1),t=document.getElementById(n);if(t){const e=t.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:e,behavior:"smooth"})}})});let s=!1;window.addEventListener("scroll",function(){s||(requestAnimationFrame(function(){a(),s=!1}),s=!0)}),a();function r(){window.innerWidth<=1200?e.style.display="none":e.style.display="block"}window.addEventListener("resize",r),r()})