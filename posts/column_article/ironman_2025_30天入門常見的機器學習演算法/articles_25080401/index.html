<!DOCTYPE html>
<html lang="zh-tw">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">

  <title>(Day 6) 邏輯迴歸 (多項式 &#43; 正規化) | 志謙&#39;s Blog</title>

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="..." crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="..." crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="..." crossorigin="anonymous"
  onload="renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false}
    ]
  });"></script>

  <meta name="description" content="">

  

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="(Day 6) 邏輯迴歸 (多項式 &#43; 正規化) | 志謙&#39;s Blog">
  <meta name="twitter:description" content="在上一篇中，我們深入介紹了邏輯迴歸的模型邏輯、損失函數與分類行為。這篇則要進一步延伸這個經典模型，回答一個關鍵問題: 邏輯迴歸能否結合多項式特徵與正規化機制，來對抗非線性與過擬合問題?
在實務中，這樣的需求非常常見，但你可能很少看到「多項式邏輯迴歸」或「正規化邏輯迴歸」這樣的說法。雖然命名不常見，但本質上邏輯迴歸完全可以與這兩個技巧結合使用，而且這種搭配在複雜資料下是極具威力的實務技巧。
為什麼邏輯迴歸可以搭配多項式與正規化?
邏輯迴歸其實是線性模型
邏輯迴歸雖然應用在分類任務f，但本質仍是一種「線性模型」:
$$
\hat{y} = \sigma(\beta_0 &#43; \mathbf{x}^\top \boldsymbol{\beta})
$$
這表示它只能建構一條線性的 decision boundary。當你的資料本身具有非線性邊界時，例如 XOR 類型的資料，這條邏輯迴歸線就顯得力不從心。
解法之一，就是在原始特徵上做多項式擴展 (Polynomial Feature Expansion)——也就是增加特徵空間的非線性組合，例如 $x_1^2$、$x_1 \cdot x_2$ 等，來幫助模型在更高維度中建立線性可分的邊界。
這與之前我們在線性迴歸所談的邏輯迴歸原理一樣，只是這次應用在分類問題中。
邏輯迴歸也容易過擬合
一旦你使用多項式特徵，特徵數暴增，就可能發生過擬合，這時就需要正規化 (Regularization) 機制來抑制模型複雜度。
與 Linear Regression 一樣，邏輯迴歸可以透過 L1 或 L2 懲罰項達到正規化的目的:

L2 (Ridge): 抑制權重值變得太大
L1 (Lasso): 推動部分權重變為 0，具有特徵選擇效果
Elastic Net: L1 &#43; L2 混合調整

值得注意的是，在 PyTorch 中，optimizer 的 weight_decay 只對應 L2，若要做 L1，則需自行加上額外的懲罰項。
模型實作
這個案例也一樣，使用 PyTorch 來實現，透過這段程式碼來窺探 Logistic Regression 的細節。但是還是要再次聲明一下，不論是機器學習演算法，還是說什麼排序的那些算法，你自己寫的打概率打不過這種主流套件做出來的方法，因為這些方法可能經過 10 幾年以上的迭代，不斷地維護與優化產生的，所以如果是學習的話可以自己做，但是正式要使用的話還是建議直接用這些現成的方法，表現往往更加優秀。">
  <meta name="twitter:image" content="http://twcch.io/images/post/common/data_science_competition_01.png">

  
  <meta property="og:title" content="(Day 6) 邏輯迴歸 (多項式 &#43; 正規化) | 志謙&#39;s Blog">
  <meta property="og:description" content="在上一篇中，我們深入介紹了邏輯迴歸的模型邏輯、損失函數與分類行為。這篇則要進一步延伸這個經典模型，回答一個關鍵問題: 邏輯迴歸能否結合多項式特徵與正規化機制，來對抗非線性與過擬合問題?
在實務中，這樣的需求非常常見，但你可能很少看到「多項式邏輯迴歸」或「正規化邏輯迴歸」這樣的說法。雖然命名不常見，但本質上邏輯迴歸完全可以與這兩個技巧結合使用，而且這種搭配在複雜資料下是極具威力的實務技巧。
為什麼邏輯迴歸可以搭配多項式與正規化?
邏輯迴歸其實是線性模型
邏輯迴歸雖然應用在分類任務f，但本質仍是一種「線性模型」:
$$
\hat{y} = \sigma(\beta_0 &#43; \mathbf{x}^\top \boldsymbol{\beta})
$$
這表示它只能建構一條線性的 decision boundary。當你的資料本身具有非線性邊界時，例如 XOR 類型的資料，這條邏輯迴歸線就顯得力不從心。
解法之一，就是在原始特徵上做多項式擴展 (Polynomial Feature Expansion)——也就是增加特徵空間的非線性組合，例如 $x_1^2$、$x_1 \cdot x_2$ 等，來幫助模型在更高維度中建立線性可分的邊界。
這與之前我們在線性迴歸所談的邏輯迴歸原理一樣，只是這次應用在分類問題中。
邏輯迴歸也容易過擬合
一旦你使用多項式特徵，特徵數暴增，就可能發生過擬合，這時就需要正規化 (Regularization) 機制來抑制模型複雜度。
與 Linear Regression 一樣，邏輯迴歸可以透過 L1 或 L2 懲罰項達到正規化的目的:

L2 (Ridge): 抑制權重值變得太大
L1 (Lasso): 推動部分權重變為 0，具有特徵選擇效果
Elastic Net: L1 &#43; L2 混合調整

值得注意的是，在 PyTorch 中，optimizer 的 weight_decay 只對應 L2，若要做 L1，則需自行加上額外的懲罰項。
模型實作
這個案例也一樣，使用 PyTorch 來實現，透過這段程式碼來窺探 Logistic Regression 的細節。但是還是要再次聲明一下，不論是機器學習演算法，還是說什麼排序的那些算法，你自己寫的打概率打不過這種主流套件做出來的方法，因為這些方法可能經過 10 幾年以上的迭代，不斷地維護與優化產生的，所以如果是學習的話可以自己做，但是正式要使用的話還是建議直接用這些現成的方法，表現往往更加優秀。">
  <meta property="og:image" content="http://twcch.io/images/post/common/data_science_competition_01.png">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,600%7CPoppins:400,600,700&display=swap" as="style">
  <link href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,600%7CPoppins:400,600,700&display=swap" rel="stylesheet">

  
  <link rel="preload" href="https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css" as="style">
  <link href="https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css" rel="stylesheet">

  
  
  <style>/*!------------------------------------------------------------------
[MAIN STYLESHEET]
-------------------------------------------------------------------*/.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.show{display:block}.hide{display:none}.invisible{visibility:hidden}.list-reset{list-style-type:none;margin:0;padding:0}.clearfix::after,.clearfix ::before{content:"";display:table;clear:both}.screen-reader-text{clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;position:absolute!important;width:1px;word-wrap:normal!important}/*!normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css*/html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,dl,dd,ol,ul,fieldset,legend,figure,hr{margin:0;padding:0}li>ul,li>ol{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}h1,h2,h3,h4,h5,h6,ul,ol,dl,blockquote,p,address,hr,table,fieldset,figure,pre{margin-bottom:30px}ul,ol,dd{margin-left:20px}.highlight{color:#fff;background:#0a0a12}.highlighter-rouge .highlight{background:#eef}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:700}.highlight .o{font-weight:700}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:700}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:700;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:700}.highlight .gu{color:#fff}.highlight .gt{color:#a00}.highlight .kc{font-weight:700}.highlight .kd{font-weight:700}.highlight .kp{font-weight:700}.highlight .kr{font-weight:700}.highlight .kt{color:#458;font-weight:700}.highlight .m{color:#099}.highlight .s{color:#e03460}.highlight .na{color:teal}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:700}.highlight .no{color:teal}.highlight .ni{color:purple}.highlight .ne{color:#900;font-weight:700}.highlight .nf{color:#900;font-weight:700}.highlight .nn{color:#555}.highlight .nt{color:#6565ff}.highlight .nv{color:teal}.highlight .ow{font-weight:700}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#e03460}.highlight .sc{color:#e03460}.highlight .sd{color:#e03460}.highlight .s2{color:#e03460}.highlight .se{color:#e03460}.highlight .sh{color:#e03460}.highlight .si{color:#e03460}.highlight .sx{color:#e03460}.highlight .sr{color:#009926}.highlight .s1{color:#e03460}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:teal}.highlight .vg{color:teal}.highlight .vi{color:teal}.highlight .il{color:#099}.container{max-width:1300px;padding-left:20px;padding-right:20px;margin:0 auto}.container-big{max-width:1600px;padding-left:20px;padding-right:20px;margin:0 auto}.row{display:flex;flex-wrap:wrap;flex:initial;flex-direction:row;box-sizing:border-box;margin-left:-15px;margin-right:-15px}.col{padding-left:15px;padding-right:15px}[class^=col-]{flex:auto}.col-0{width:0%}.col-1{width:8.33333333%}.col-2{width:16.66666667%}.col-3{width:25%}.col-4{width:33.33333333%}.col-5{width:41.66666667%}.col-6{width:50%}.col-7{width:58.33333333%}.col-8{width:66.66666667%}.col-9{width:75%}.col-10{width:83.33333333%}.col-11{width:91.66666667%}.col-12{width:100%}.push-0{margin-left:0%}.push-1{margin-left:8.33333333%}.push-2{margin-left:16.66666667%}.push-3{margin-left:25%}.push-4{margin-left:33.33333333%}.push-5{margin-left:41.66666667%}.push-6{margin-left:50%}.push-7{margin-left:58.33333333%}.push-8{margin-left:66.66666667%}.push-9{margin-left:75%}.push-10{margin-left:83.33333333%}.push-11{margin-left:91.66666667%}.push-12{margin-left:100%}.pull-0{margin-right:0%}.pull-1{margin-right:8.33333333%}.pull-2{margin-right:16.66666667%}.pull-3{margin-right:25%}.pull-4{margin-right:33.33333333%}.pull-5{margin-right:41.66666667%}.pull-6{margin-right:50%}.pull-7{margin-right:58.33333333%}.pull-8{margin-right:66.66666667%}.pull-9{margin-right:75%}.pull-10{margin-right:83.33333333%}.pull-11{margin-right:91.66666667%}.pull-12{margin-right:100%}@media(max-width:992px){.col-d-0{width:0%}.col-d-1{width:8.33333333%}.col-d-2{width:16.66666667%}.col-d-3{width:25%}.col-d-4{width:33.33333333%}.col-d-5{width:41.66666667%}.col-d-6{width:50%}.col-d-7{width:58.33333333%}.col-d-8{width:66.66666667%}.col-d-9{width:75%}.col-d-10{width:83.33333333%}.col-d-11{width:91.66666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.33333333%}.push-d-2{margin-left:16.66666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.33333333%}.push-d-5{margin-left:41.66666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.33333333%}.push-d-8{margin-left:66.66666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.33333333%}.push-d-11{margin-left:91.66666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.33333333%}.pull-d-2{margin-right:16.66666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.33333333%}.pull-d-5{margin-right:41.66666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.33333333%}.pull-d-8{margin-right:66.66666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.33333333%}.pull-d-11{margin-right:91.66666667%}.pull-d-12{margin-right:100%}}@media(max-width:768px){.col-t-0{width:0%}.col-t-1{width:8.33333333%}.col-t-2{width:16.66666667%}.col-t-3{width:25%}.col-t-4{width:33.33333333%}.col-t-5{width:41.66666667%}.col-t-6{width:50%}.col-t-7{width:58.33333333%}.col-t-8{width:66.66666667%}.col-t-9{width:75%}.col-t-10{width:83.33333333%}.col-t-11{width:91.66666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.33333333%}.push-t-2{margin-left:16.66666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.33333333%}.push-t-5{margin-left:41.66666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.33333333%}.push-t-8{margin-left:66.66666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.33333333%}.push-t-11{margin-left:91.66666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.33333333%}.pull-t-2{margin-right:16.66666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.33333333%}.pull-t-5{margin-right:41.66666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.33333333%}.pull-t-8{margin-right:66.66666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.33333333%}.pull-t-11{margin-right:91.66666667%}.pull-t-12{margin-right:100%}}@media(max-width:576px){.col-m-0{width:0%}.col-m-1{width:8.33333333%}.col-m-2{width:16.66666667%}.col-m-3{width:25%}.col-m-4{width:33.33333333%}.col-m-5{width:41.66666667%}.col-m-6{width:50%}.col-m-7{width:58.33333333%}.col-m-8{width:66.66666667%}.col-m-9{width:75%}.col-m-10{width:83.33333333%}.col-m-11{width:91.66666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.33333333%}.push-m-2{margin-left:16.66666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.33333333%}.push-m-5{margin-left:41.66666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.33333333%}.push-m-8{margin-left:66.66666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.33333333%}.push-m-11{margin-left:91.66666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.33333333%}.pull-m-2{margin-right:16.66666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.33333333%}.pull-m-5{margin-right:41.66666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.33333333%}.pull-m-8{margin-right:66.66666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.33333333%}.pull-m-11{margin-right:91.66666667%}.pull-m-12{margin-right:100%}}@media(max-width:992px){.col-d-0{width:0%}.col-d-1{width:8.33333333%}.col-d-2{width:16.66666667%}.col-d-3{width:25%}.col-d-4{width:33.33333333%}.col-d-5{width:41.66666667%}.col-d-6{width:50%}.col-d-7{width:58.33333333%}.col-d-8{width:66.66666667%}.col-d-9{width:75%}.col-d-10{width:83.33333333%}.col-d-11{width:91.66666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.33333333%}.push-d-2{margin-left:16.66666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.33333333%}.push-d-5{margin-left:41.66666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.33333333%}.push-d-8{margin-left:66.66666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.33333333%}.push-d-11{margin-left:91.66666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.33333333%}.pull-d-2{margin-right:16.66666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.33333333%}.pull-d-5{margin-right:41.66666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.33333333%}.pull-d-8{margin-right:66.66666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.33333333%}.pull-d-11{margin-right:91.66666667%}.pull-d-12{margin-right:100%}}@media(max-width:768px){.col-t-0{width:0%}.col-t-1{width:8.33333333%}.col-t-2{width:16.66666667%}.col-t-3{width:25%}.col-t-4{width:33.33333333%}.col-t-5{width:41.66666667%}.col-t-6{width:50%}.col-t-7{width:58.33333333%}.col-t-8{width:66.66666667%}.col-t-9{width:75%}.col-t-10{width:83.33333333%}.col-t-11{width:91.66666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.33333333%}.push-t-2{margin-left:16.66666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.33333333%}.push-t-5{margin-left:41.66666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.33333333%}.push-t-8{margin-left:66.66666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.33333333%}.push-t-11{margin-left:91.66666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.33333333%}.pull-t-2{margin-right:16.66666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.33333333%}.pull-t-5{margin-right:41.66666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.33333333%}.pull-t-8{margin-right:66.66666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.33333333%}.pull-t-11{margin-right:91.66666667%}.pull-t-12{margin-right:100%}}@media(max-width:576px){.col-m-0{width:0%}.col-m-1{width:8.33333333%}.col-m-2{width:16.66666667%}.col-m-3{width:25%}.col-m-4{width:33.33333333%}.col-m-5{width:41.66666667%}.col-m-6{width:50%}.col-m-7{width:58.33333333%}.col-m-8{width:66.66666667%}.col-m-9{width:75%}.col-m-10{width:83.33333333%}.col-m-11{width:91.66666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.33333333%}.push-m-2{margin-left:16.66666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.33333333%}.push-m-5{margin-left:41.66666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.33333333%}.push-m-8{margin-left:66.66666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.33333333%}.push-m-11{margin-left:91.66666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.33333333%}.pull-m-2{margin-right:16.66666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.33333333%}.pull-m-5{margin-right:41.66666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.33333333%}.pull-m-8{margin-right:66.66666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.33333333%}.pull-m-11{margin-right:91.66666667%}.pull-m-12{margin-right:100%}}@media(max-width:992px){.col-d-0{width:0%}.col-d-1{width:8.33333333%}.col-d-2{width:16.66666667%}.col-d-3{width:25%}.col-d-4{width:33.33333333%}.col-d-5{width:41.66666667%}.col-d-6{width:50%}.col-d-7{width:58.33333333%}.col-d-8{width:66.66666667%}.col-d-9{width:75%}.col-d-10{width:83.33333333%}.col-d-11{width:91.66666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.33333333%}.push-d-2{margin-left:16.66666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.33333333%}.push-d-5{margin-left:41.66666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.33333333%}.push-d-8{margin-left:66.66666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.33333333%}.push-d-11{margin-left:91.66666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.33333333%}.pull-d-2{margin-right:16.66666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.33333333%}.pull-d-5{margin-right:41.66666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.33333333%}.pull-d-8{margin-right:66.66666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.33333333%}.pull-d-11{margin-right:91.66666667%}.pull-d-12{margin-right:100%}}@media(max-width:768px){.col-t-0{width:0%}.col-t-1{width:8.33333333%}.col-t-2{width:16.66666667%}.col-t-3{width:25%}.col-t-4{width:33.33333333%}.col-t-5{width:41.66666667%}.col-t-6{width:50%}.col-t-7{width:58.33333333%}.col-t-8{width:66.66666667%}.col-t-9{width:75%}.col-t-10{width:83.33333333%}.col-t-11{width:91.66666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.33333333%}.push-t-2{margin-left:16.66666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.33333333%}.push-t-5{margin-left:41.66666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.33333333%}.push-t-8{margin-left:66.66666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.33333333%}.push-t-11{margin-left:91.66666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.33333333%}.pull-t-2{margin-right:16.66666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.33333333%}.pull-t-5{margin-right:41.66666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.33333333%}.pull-t-8{margin-right:66.66666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.33333333%}.pull-t-11{margin-right:91.66666667%}.pull-t-12{margin-right:100%}}@media(max-width:576px){.col-m-0{width:0%}.col-m-1{width:8.33333333%}.col-m-2{width:16.66666667%}.col-m-3{width:25%}.col-m-4{width:33.33333333%}.col-m-5{width:41.66666667%}.col-m-6{width:50%}.col-m-7{width:58.33333333%}.col-m-8{width:66.66666667%}.col-m-9{width:75%}.col-m-10{width:83.33333333%}.col-m-11{width:91.66666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.33333333%}.push-m-2{margin-left:16.66666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.33333333%}.push-m-5{margin-left:41.66666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.33333333%}.push-m-8{margin-left:66.66666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.33333333%}.push-m-11{margin-left:91.66666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.33333333%}.pull-m-2{margin-right:16.66666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.33333333%}.pull-m-5{margin-right:41.66666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.33333333%}.pull-m-8{margin-right:66.66666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.33333333%}.pull-m-11{margin-right:91.66666667%}.pull-m-12{margin-right:100%}}img[data-action=zoom]{cursor:pointer;cursor:-webkit-zoom-in;cursor:-moz-zoom-in}.zoom-img,.zoom-img-wrap{position:relative;z-index:666;-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}img.zoom-img{cursor:pointer;cursor:-webkit-zoom-out;cursor:-moz-zoom-out}.zoom-overlay{z-index:420;background:#16151f;position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;opacity:0;-webkit-transition:opacity 300ms;-o-transition:opacity 300ms;transition:opacity 300ms}@supports(-webkit-backdrop-filter:none) or (backdrop-filter:none){.zoom-overlay{-webkit-backdrop-filter:saturate(180%)blur(10px);backdrop-filter:saturate(180%)blur(10px);background:rgba(22,21,31,.8)}}.zoom-overlay-open .zoom-overlay{opacity:1}.zoom-overlay-open,.zoom-overlay-transitioning{cursor:default}.animate{animation:animateElement cubic-bezier(.3,.45,.45,.95).75s;animation-duration:.75s;animation-iteration-count:1;transition:transform .2s}@keyframes animateElement{0%{opacity:0;transform:translate(0,50px)}100%{opacity:1;transform:translate(0,0)}}*,*::after,*::before{box-sizing:border-box}body{font-family:josefin sans,sans-serif;font-size:18px;line-height:1.7;color:#fff;background-color:#16151f;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow-x:hidden}body.is-in::after{visibility:hidden;opacity:0;pointer-events:none}body::after{content:"";position:fixed;left:0;top:0;width:100%;height:100%;background-color:#0a0a12;z-index:999;transition:1s}body input,body textarea{border:1px solid #c6c6c6;outline:none}@media only screen and (max-width:576px){body{font-size:16px;line-height:29px}}::placeholder{color:#757575}*::selection{color:#fff;background-color:rgba(50,58,150,.7)}h1,h2,h3,h4,h5,h6{font-family:poppins,Arial,sans-serif;font-weight:700;line-height:1.4em;color:#fff}h1{font-size:36px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}blockquote{position:relative;padding:20px 20px 20px 45px;font-family:poppins,Arial,sans-serif;font-size:21px;line-height:37px;font-weight:700;color:#fff}blockquote:before{content:'\201C';position:absolute;font-family:poppins,Arial,sans-serif;top:.3em;left:-.01em;font-size:4em;color:rgba(255,255,255,.6)}blockquote cite{font-size:16px;font-style:normal;color:#fff}blockquote cite:before{content:'\2014' '\00a0'}@media only screen and (max-width:576px){blockquote{padding:20px 20px 20px 35px;font-size:18px;line-height:28px}}pre{overflow:auto;padding:15px;font-size:14px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}code[class*=language-],pre[class*=language-]{white-space:pre-wrap;word-break:break-all;line-height:inherit}img,.zoom-img-wrap{max-width:100%;height:auto;vertical-align:middle}img+em,.zoom-img-wrap+em{display:inline-block;width:100%;padding:13px;font-size:14px;font-style:normal;line-height:1;text-align:center;color:rgba(255,255,255,.8);background-color:#0a0a12}a{text-decoration:none;color:#fff;transition:all .2s}a:hover{color:#323a96}hr{display:block;width:100%;height:1px;margin:50px 0;border:0;background:rgba(255,255,255,.1)}.table-container{display:block;max-width:100%;overflow-x:auto}table{font-size:12px;color:rgba(255,255,255,.6);width:100%;border-width:1px;border-color:#0a0a12;border-collapse:collapse}table th{padding:10px;font-size:16px;text-align:left;border:1px solid #0a0a12;color:#fff;background-color:#323a96}table tr{background-color:#0a0a12;transition:all .3s ease}table tr:nth-child(even){background-color:transparent}table td{padding:10px;font-size:14px;border:1px solid #0a0a12}table tr:hover{color:#fff}.gallery-box{margin-bottom:30px}.gallery-box em{display:inline-block;width:100%;padding:13px;font-size:14px;font-style:normal;line-height:1;text-align:center;color:rgba(255,255,255,.8);background-color:#0a0a12}.gallery-box em a{text-decoration:underline;border-bottom:none}.gallery{display:grid;grid-template-columns:repeat(3,auto);justify-content:center;align-content:center;grid-gap:10px}.gallery img{width:100%;height:auto}.hero{position:relative;margin-bottom:30px;border-radius:30px;overflow:hidden;box-shadow:0 5px 10px rgba(0,0,0,.15);background-color:#0a0a12}@media only screen and (max-width:992px){.hero{border-radius:30px}}@media only screen and (max-width:576px){.hero{box-shadow:none}}.hero__inner::before{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;border-radius:30px;background-color:rgba(16,17,30,.6)}@media only screen and (max-width:992px){.hero__inner::before{border-radius:30px}}.hero__image{padding-top:50%;min-height:280px;user-select:none}.hero__image img{position:absolute;top:0;width:100%;height:100%;object-fit:cover}@media only screen and (max-width:992px){.hero__image{padding-top:55%}}@media only screen and (max-width:768px){.hero__image{padding-top:65%}}.hero__content{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;width:100%;max-width:650px;padding:0 20px;text-align:center}.hero__title{font-size:57px;margin:0 0 10px;color:#fff}@media only screen and (max-width:576px){.hero__title{font-size:43px;margin:0 0 5px}}.hero__desc{font-size:18px;color:rgba(255,255,255,.8);margin:0}@media only screen and (max-width:576px){.hero__desc{font-size:15px;line-height:21px}}.hero-without-image{margin:50px 0 80px}.hero-without-image .hero-inner{display:flex;align-items:center;justify-content:center}.hero-without-image .hero-content{width:100%;max-width:650px;padding:0 20px;text-align:center}@media only screen and (max-width:576px){.hero-without-image{margin:20px 0 50px}}.top{position:fixed;bottom:25px;right:-100px;z-index:5;width:40px;height:40px;line-height:40px;text-align:center;border-radius:5px;background-color:#0a0a12;color:#fff;cursor:pointer;transition:all .25s ease}.top.is-active{right:30px}@media only screen and (max-width:768px){.top{bottom:15px}.top.is-active{right:25px}}.header{width:100%;margin:35px 0;transition:all .2s;color:#fff}@media only screen and (max-width:992px){.header{margin:25px 0}}.header__inner{position:relative;display:flex;justify-content:space-between;align-items:center}.logo__link{font-family:poppins,Arial,sans-serif;font-size:27px;line-height:1;font-weight:700;vertical-align:middle;color:#fff;text-transform:uppercase;text-decoration:none;letter-spacing:2px;transition:none}.logo__link:hover{color:#fff}.logo__image{max-height:40px}.main-nav{width:100%;max-width:1300px;margin:0 auto}.main-nav__box{display:flex;align-items:center;width:80%;padding-top:200px;margin:0 auto}.main-nav__box .nav__icon-close{position:absolute;top:20px;right:40px;z-index:5;display:flex;align-items:center;justify-content:center;font-size:30px;width:40px;height:40px;text-align:center;line-height:40px;color:rgba(255,255,255,.5);transition:all .25s ease;cursor:pointer}.main-nav__box .nav__icon-close:hover{color:#fff}@media only screen and (max-width:768px){.main-nav__box{padding-top:100px}.main-nav__box .nav__icon-close{top:22px;right:42px}}@media only screen and (max-width:576px){.main-nav__box{width:90%}}.navigation{display:flex;align-items:center}.top-nav{margin-right:25px}.top-nav .nav__list .nav__item{display:inline-block;margin-right:25px}.top-nav .nav__list .nav__item:last-child{margin-right:0}.top-nav .nav__list .nav__item .nav__link{position:relative;font-size:16px;font-weight:400;text-decoration:none;color:#fff}.top-nav .nav__list .nav__item .nav__link:hover::before{opacity:1;visibility:visible}.top-nav .nav__list .nav__item .nav__link::before{content:"";position:absolute;left:50%;top:-15px;transform:translateX(-50%);display:block;width:7px;height:7px;border-radius:50%;transition:all .25s;opacity:0;visibility:hidden;background-color:#323a96}@media only screen and (max-width:992px){.top-nav{display:none}}.mobile-nav .nav__list .nav__item{display:block;margin-bottom:35px;text-align:center}.mobile-nav .nav__list .nav__item:last-child{margin-bottom:0}.mobile-nav .nav__list .nav__item .nav__link{position:relative;font-size:18px;color:#fff}@media only screen and (max-width:576px){.mobile-nav .nav__list .nav__item{margin-bottom:20px}}.nav-buttons{display:flex;align-items:center;font-size:24px;color:#fff}.nav-buttons .nav__icon-menu{display:none}@media only screen and (max-width:992px){.nav-buttons .nav__icon-menu{display:block}}.nav-buttons .nav__icon{cursor:pointer}.nav-buttons .nav__icon:first-child{margin-right:15px}.menu-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:-1;opacity:0;visibility:hidden;background-color:#0a0a12;transition:all .5s ease-in-out}.menu-overlay.is-open{z-index:100;opacity:1;visibility:visible}@supports(-webkit-backdrop-filter:none) or (backdrop-filter:none){.menu-overlay{-webkit-backdrop-filter:saturate(180%)blur(10px);backdrop-filter:saturate(180%)blur(10px);background-color:rgba(10,10,18,.9)}}@media only screen and (min-width:992px){.menu-overlay{display:none}}.nav-grid{width:100%;height:75vh;overflow-y:auto}.nav-grid__item{margin-bottom:30px}@media only screen and (max-width:768px){.nav-grid__item{height:auto}}.nav-grid__title{position:relative;margin-bottom:50px;padding-bottom:15px;font-size:30px;font-weight:700;text-align:center;color:#fff}.nav-grid__title::after{content:"";position:absolute;left:50%;bottom:0;transform:translate(-50%,-50%);display:block;width:25px;height:2px;background-color:#fff}@media only screen and (max-width:768px){.nav-grid__title{margin-bottom:30px}}.search{position:fixed;top:0;left:0;right:0;bottom:0;z-index:-1;opacity:0;visibility:hidden;background-color:#0a0a12;transition:all .5s ease-in-out}.search.is-visible{z-index:100;opacity:1;visibility:visible}@supports(-webkit-backdrop-filter:none) or (backdrop-filter:none){.search{-webkit-backdrop-filter:saturate(180%)blur(10px);backdrop-filter:saturate(180%)blur(10px);background-color:rgba(10,10,18,.9)}}.search__box{position:relative;max-width:650px;width:100%;margin:0 auto;padding-top:200px}.search__box .search__close{position:absolute;top:50%;right:20px;transform:translateY(-50%);font-size:30px;line-height:1;color:rgba(255,255,255,.5);transition:all .25s;cursor:pointer}.search__box .search__close:hover{color:#fff}@media only screen and (max-width:768px){.search__box{width:80%;padding-top:100px}}@media only screen and (max-width:576px){.search__box{width:90%}}.search__group{position:relative;margin-bottom:30px}.search__group .search__text{width:100%;height:auto;padding:15px 20px;font-family:poppins,Arial,sans-serif;font-size:28px;font-weight:700;line-height:42px;border-radius:5px;border:3px solid rgba(255,255,255,.5);transition:all .3s;color:#fff;background-color:transparent}.search__group .search__text::-webkit-input-placeholder{font-weight:700;color:rgba(255,255,255,.5)}.search__group .search__text::placeholder{font-weight:700;color:rgba(255,255,255,.5)}.search__group .search__text::-ms-clear{display:none}.search__group .search__text:focus{color:#fff;border-color:#323a96}@media only screen and (max-width:576px){.search__group .search__text{font-size:26px}}.search-results-list{height:55vh;padding:0 0 25px;list-style:circle;font-weight:700;color:#fff;overflow:auto;white-space:normal}.search-results-list .search-counter{margin-left:5px}.search-results-list .search-results__item{padding-bottom:15px;margin-bottom:15px;display:list-item;list-style-type:none;border-bottom:1px solid rgba(255,255,255,.1)}.search-results-list .search-results__link{position:relative;display:block;margin-left:-15px;padding-left:20px;font-size:18px;line-height:24px;font-weight:700;color:#fff;transition:all .25s ease-in-out}.search-results-list .search-results__link:hover{margin-left:15px}.search-results-list .search-results__link::before{content:"";position:absolute;top:6px;left:0;width:7px;height:7px;border-radius:50%;border:1px solid #fff}.search-results-list .search-results-date{font-size:12px;line-height:1;font-weight:400;color:rgba(255,255,255,.6)}.search-results-list .no-results{list-style:none}.search-results-list .no-results h3{font-size:18px}.load-more{margin:0 auto}.load-more-section{margin:30px auto;text-align:center}@media only screen and (max-width:576px){.load-more-section{margin:20px auto}}.load-more-posts i{margin-left:5px}.footer-widgets{padding:80px 0 30px;margin-top:20px;background-color:#0a0a12}.footer-widgets .row .col{flex-grow:1}.footer-widgets .row .col:last-child>.widget{padding-right:0}@media only screen and (max-width:768px){.footer-widgets{padding:80px 0 0}}@media only screen and (max-width:576px){.footer-widgets{padding:50px 0 0}}@media only screen and (max-width:768px){.widget{margin-bottom:60px}}.widget__title{position:relative;margin-bottom:20px;font-size:30px;line-height:1;color:#fff}@media only screen and (max-width:992px){.widget__title{font-size:24px}}.footer-logo{margin-bottom:20px;font-family:Poppins,Arial,sans-serif;font-size:27px;line-height:33px;font-weight:700;color:#fff;text-transform:uppercase;letter-spacing:2px;transition:none}.footer-desc{margin-bottom:0;font-size:16px;line-height:24px;color:rgba(255,255,255,.6)}.widget-nav{padding-right:30px}.widget-nav .nav__item{margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid rgba(255,255,255,.1)}.widget-nav .nav__item:last-child{margin-bottom:0}.widget-nav .nav__link{font-size:16px;color:#fff}@media only screen and (max-width:992px){.widget-nav{padding-right:0}}@media only screen and (max-width:768px){.widget-subscribe{margin-bottom:0}}.subscribe-subtitle{width:100%;margin-bottom:20px;font-size:16px;line-height:26px;color:rgba(255,255,255,.6)}@media only screen and (max-width:768px){.subscribe-subtitle{max-width:100%}}.subscribe-group-top{display:flex;align-items:center}.subscribe-group-top .subscribe-email{position:relative;width:100%;height:50px;padding:8px 15px;font-family:poppins,Arial,sans-serif;font-size:13px;border-radius:5px;line-height:50px;color:#0a0a12;background-color:#fff;border:1px solid #c6c6c6;outline:0;-webkit-appearance:none;box-sizing:border-box;transition:border-color .2s ease-in-out;cursor:text}.subscribe-group-top .subscribe-button{margin-left:10px}.footer{position:relative;padding:50px 0;background-color:#0a0a12}.footer .footer__inner{display:flex;justify-content:space-between;align-items:center}@media only screen and (max-width:768px){.footer .footer__inner{flex-direction:column;align-items:flex-start}}.copyright{font-size:13px;color:rgba(255,255,255,.6)}.copyright a{color:#fff}.social{text-align:center}.social .social__list{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.social .social__item{display:inline-block;margin-left:10px}.social .social__item:first-child{margin-left:0}.social .social__link{display:flex;justify-content:center;align-items:center;width:40px;height:40px;font-size:18px;line-height:40px;border-radius:3px;color:#fff;background-color:#16151f}.social .social__link:hover{background-color:#323a96}@media only screen and (max-width:992px){.social .social__link{width:30px;height:30px;line-height:30px;font-size:16px}}@media only screen and (max-width:768px){.social{margin-bottom:5px}.social .social__item{margin-bottom:10px}}.button{display:inline-block;white-space:nowrap;vertical-align:middle;font:inherit;border:none;border-radius:5px;outline:none;-webkit-appearance:none;text-align:center;text-decoration:none;color:#fff;transition:all .2s ease;cursor:pointer}.button:hover{color:#fff}.button--primary{padding:0 1.8rem;height:50px;font-size:16px;font-weight:600;line-height:50px;background-color:#323a96}.button--primary:hover{background-color:#2c3383}.button--middle{position:relative;height:60px;width:100%;max-width:280px;font-family:poppins,Arial,sans-serif;font-size:12px;line-height:60px;font-weight:600;letter-spacing:1px;text-transform:uppercase;transition:all .2s ease;background-color:#0a0a12}.button--middle:hover{background-color:#08080f}.button--small{height:28px;line-height:28px;display:inline-block;border-radius:30px;padding:0 15px;color:#fff;background-color:#323a96}.button--small:hover{background-color:#2c3383}.button--small::before{content:none!important}.button--big{display:block;width:100%}.article{align-items:stretch;flex-grow:1;min-height:380px;margin-bottom:30px}.article:hover{transform:translateY(-5px)}@media only screen and (max-width:576px){.article{min-height:280px}}.article__inner{position:relative;display:flex;width:100%;height:100%;border-radius:30px;overflow:hidden;box-shadow:0 5px 10px rgba(0,0,0,.15);background-color:#0a0a12}.article__inner .featured-post{position:absolute;top:0;right:0;z-index:10;width:35px;height:35px;display:flex;justify-content:center;align-items:center;font-size:18px;color:rgba(255,255,255,.8);user-select:none}.article__inner .featured-post::before{content:"";position:absolute;top:0;right:0;width:100%;height:100%;border-color:#323a96 #323a96 transparent transparent;border-style:solid;border-width:29px}.article__inner .featured-post i{position:relative}.article__title{margin:10px 0 15px;font-size:21px}.article__title a{color:#fff}@media only screen and (max-width:576px){.article__title{margin:5px 0 10px;font-size:18px}}.article__excerpt{margin-bottom:15px;font-size:15px;color:rgba(255,255,255,.6)}.article__excerpt p{margin:0}@media only screen and (max-width:576px){.article__excerpt{margin-bottom:10px;font-size:13px;line-height:21px}}.article__image{position:absolute;display:block;width:100%;height:100%;overflow:hidden;user-select:none;background-color:#0a0a12}.article__image::after{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(16,17,30,.6);pointer-events:none}.article__image img{position:absolute;top:0;width:100%;height:100%;object-fit:cover;pointer-events:none}@media only screen and (max-width:768px){.article__image{padding-top:75%}}@media only screen and (max-width:576px){.article__image{padding-top:80%}}.article__content{z-index:1;width:100%;margin-top:auto;padding:0 30px 30px}@media only screen and (max-width:576px){.article__content{padding:20px}}.article__meta{display:flex;align-items:center;flex-wrap:wrap;justify-content:flex-start;color:#fff}.article-tags{display:flex;flex-wrap:wrap;align-items:center}.article-tags__box{position:relative;display:flex;flex-wrap:wrap;align-items:center;line-height:1}.article-tags__box .article__tag{height:23px;padding:0 10px;margin:0 5px 5px 0;text-transform:uppercase;font-family:poppins,Arial,sans-serif;font-size:10px;line-height:23px;letter-spacing:1px;font-weight:700;border-radius:30px;color:rgba(255,255,255,.9);background-color:#323a96}.article-tags__box .article__tag:hover{background-color:#2c3383}.article-tags__box .article__tag:last-child{margin-right:0}@media only screen and (max-width:576px){.article-tags__box .article__tag{height:20px;line-height:20px}}.article__date{font-size:14px;color:#fff}.article__date::before{content:"";position:relative;bottom:.2rem;display:inline-block;height:3px;width:3px;margin:0 .5rem;border-radius:50%;background-color:rgba(255,255,255,.8)}@media only screen and (max-width:576px){.article__date{display:none}}.article__author{display:flex;align-items:center}.article__author-image{display:inline-block;width:25px;height:25px;margin-right:7px;border-radius:50%;border:1px solid rgba(255,255,255,.6);background-size:cover;background-position:50%;background-repeat:no-repeat;background-color:#0a0a12}.article__author-link{font-size:14px;text-decoration:underline;color:#fff}.article__author-link:hover{color:#fff}.article__author span{color:rgba(255,255,255,.8)}.post{position:relative;margin-bottom:30px}.post-image{position:absolute;top:0;width:100%;height:100%;object-fit:cover;user-select:none}.image-box{position:relative;padding-top:50%;min-height:280px;border-radius:30px;overflow:hidden;box-shadow:0 5px 10px rgba(0,0,0,.15);background-color:#0a0a12}@media only screen and (max-width:992px){.image-box{padding-top:55%}}@media only screen and (max-width:768px){.image-box{padding-top:65%}}.post__tags{position:relative;display:flex;justify-content:center;flex-wrap:wrap}.post__tags .post-tags__tag{height:23px;margin-right:5px;margin-bottom:5px;padding:0 10px;text-transform:uppercase;font-family:poppins,Arial,sans-serif;font-size:10px;line-height:23px;letter-spacing:1px;font-weight:700;border-radius:30px;color:rgba(255,255,255,.9);background-color:#323a96}.post__tags .post-tags__tag:hover{background-color:#2c3383}.post__tags .post-tags__tag:last-child{margin-right:0}@media only screen and (max-width:576px){.post__tags .post-tags__tag{height:20px;line-height:20px}}.post__head{margin:40px 0}.post__title{font-size:43px;margin:10px 0 15px;text-align:center}@media only screen and (max-width:768px){.post__title{font-size:38px}}@media only screen and (max-width:576px){.post__title{font-size:28px}}.post__meta{display:flex;align-items:center;flex-wrap:wrap;justify-content:center;color:#fff}.post__author{display:flex;align-items:center}.post__author-image{display:inline-block;width:25px;height:25px;margin-right:7px;border-radius:50%;border:1px solid rgba(255,255,255,.6);background-size:cover;background-position:50%;background-repeat:no-repeat;background-color:#0a0a12}.post__author-link{font-size:14px;text-decoration:underline;color:#fff}.post__author-link:hover{color:#fff}.post__author span{color:rgba(255,255,255,.8)}.post__date{font-size:14px;color:#fff}.post__date::before{content:"";position:relative;bottom:.2rem;display:inline-block;height:3px;width:3px;margin:0 .5rem;border-radius:50%;background-color:rgba(255,255,255,.8)}.post__content{color:rgba(255,255,255,.6)}.post__content a:hover{color:#fff;text-decoration:underline}.post__share{margin-bottom:80px}.post__share .share__head{text-align:center}.post__share .share__title{position:relative;display:inline-block;margin-bottom:25px;font-family:poppins,Arial,sans-serif;font-size:15px;font-weight:700;letter-spacing:1px;text-align:center;text-transform:uppercase}.post__share .share__list{display:flex;justify-content:center;align-items:center;width:100%}.post__share .share__item{margin:0 5px;text-align:center}.post__share .share__link{display:flex;justify-content:center;align-items:center;width:30px;height:30px;line-height:30px;border-radius:50%;font-size:16px;color:#0a0a12;background-color:#fff;transition:all .2s}.post__share .share__link:hover.share__facebook{color:#3b5998}.post__share .share__link:hover.share__twitter{color:#55acee}.post__share .share__link:hover.share__linkedin{color:#0077b5}.post__share .share__link:hover.share__pinterest{color:#bd081c}@media only screen and (max-width:576px){.post__share{margin-bottom:50px}}.post__navigation{display:flex;justify-content:space-between;margin-bottom:50px}.post__navigation a:first-child{margin-right:4%}.post__navigation a:last-child{margin-right:0}.post__navigation .prev,.post__navigation .next{position:relative;display:flex;align-items:flex-end;width:100%;min-height:230px;padding:0 25px 25px;border-radius:30px;overflow:hidden;transition:transform .2s,-webkit-transform .2s;box-shadow:0 5px 10px rgba(0,0,0,.15);background-size:cover;background-position:50%;background-repeat:no-repeat;background-color:#0a0a12}.post__navigation .prev::after,.post__navigation .next::after{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(16,17,30,.6);pointer-events:none}.post__navigation .prev:hover,.post__navigation .next:hover{transform:translateY(-5px)}.post__navigation .prev .post__nav,.post__navigation .next .post__nav{display:inline-block;margin-bottom:5px;font-size:13px;font-family:poppins,Arial,sans-serif;letter-spacing:1px;text-transform:uppercase;color:rgba(255,255,255,.8)}.post__navigation .prev .post__nav-box,.post__navigation .next .post__nav-box{position:relative;z-index:1;width:100%}.post__navigation .prev .post__nav__title,.post__navigation .next .post__nav__title{margin-bottom:0;font-size:21px}.post__navigation .prev .post__nav__title a,.post__navigation .next .post__nav__title a{color:#fff}.post__navigation .next{text-align:right;margin-left:auto}@media only screen and (max-width:768px){.post__navigation{flex-wrap:wrap}.post__navigation .prev,.post__navigation .next{width:100%}.post__navigation .prev{margin-bottom:20px}}.post__comments{margin-bottom:20px}.page{position:relative;margin-bottom:30px}.page__title{font-size:43px;margin-bottom:20px;text-align:center}@media only screen and (max-width:768px){.page__title{font-size:38px}}@media only screen and (max-width:768px){.page__title{font-size:28px}}.page-image{position:absolute;top:0;width:100%;height:100%;object-fit:cover;user-select:none}.image-box{position:relative;padding-top:50%;border-radius:30px;overflow:hidden;background-color:#0a0a12}@media only screen and (max-width:992px){.image-box{padding-top:55%}}@media only screen and (max-width:768px){.image-box{padding-top:65%}}.page__head{margin:40px 0}.page__content{color:rgba(255,255,255,.6)}.page__content a:hover{color:#fff;text-decoration:underline}.error{margin-bottom:0;text-align:center}.error .error__title{margin:24px 0;font-size:120px;line-height:1}.error .error__text{margin-bottom:48px;color:var(--text-alt-color)}@media only screen and (max-width:576px){.error .error__title{font-size:68px}.error .error__title{font-size:80px}.error .error__text{margin-bottom:24px}}.archive-box{position:relative;margin:50px 0 80px;text-align:center}@media only screen and (max-width:576px){.archive-box{margin:20px 0 50px}}.archive-counter{font-size:16px}.archive-title{position:relative;margin:0;font-size:47px;line-height:57px;text-transform:capitalize}@media only screen and (max-width:576px){.archive-title{font-size:40px;line-height:52px}}.form__group{margin-bottom:20px}.form__label{display:inline-block;margin-bottom:5px;font-family:poppins,Arial,sans-serif;font-size:14px;font-weight:600}.form__input{width:100%;padding:15px;font-family:poppins,Arial,sans-serif;font-size:14px;border-radius:5px}</style>
  

</head>

<body>

  

  
<header class="header">
  <div class="container">
    <div class="row">
      <div class="header__inner col col-12">

        <div class="logo">
          <a class="logo__link" href="http://twcch.io/">
            
              志謙&#39;s Blog
            
          </a>
        </div>

        <div class="menu-overlay">
          <nav class="main-nav">
            <div class="main-nav__box">
              <div class="nav__icon-close">
                <i class="ion ion-md-close"></i>
              </div>
              <div class="nav-grid">
                <div class="nav-grid__item">
                  <h2 class="nav-grid__title">Menu</h2>
                  <div class="mobile-nav">
                    <ul class="nav__list list-reset">
                      
                      <li class="nav__item">
                        <a href="/" class="nav__link">首頁</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/about" class="nav__link">關於我</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/tags/project" class="nav__link">個人專案</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/column_article" class="nav__link">專欄文章</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/posts" class="nav__link">所有文章</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/contact" class="nav__link">聯絡我</a>
                      </li>
                      
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </nav>
        </div>

        <div class="navigation">
          <div class="top-nav">
            <ul class="nav__list list-reset">
              
              <li class="nav__item">
                <a href="/" class="nav__link">首頁</a>
              </li>
              
              <li class="nav__item">
                <a href="/about" class="nav__link">關於我</a>
              </li>
              
              <li class="nav__item">
                <a href="/tags/project" class="nav__link">個人專案</a>
              </li>
              
              <li class="nav__item">
                <a href="/column_article" class="nav__link">專欄文章</a>
              </li>
              
              <li class="nav__item">
                <a href="/posts" class="nav__link">所有文章</a>
              </li>
              
              <li class="nav__item">
                <a href="/contact" class="nav__link">聯絡我</a>
              </li>
              
            </ul>
          </div>
          <div class="nav-buttons">
            <i class="nav__icon nav__icon-menu ion ion-md-menu"></i>
            <i class="nav__icon nav__icon-search ion ion-md-search"></i>
          </div>
        </div>

      </div>
    </div>
  </div>
</header>



<div class="search">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="search__box">
          <div class="search__group">
            <div class="search__close">
              <i class="ion ion-md-close"></i>
            </div>
            <label for="js-search-input" class="screen-reader-text">搜尋文章</label>
            <input type="text" id="js-search-input" class="search__text" autocomplete="off" placeholder="搜尋文章">
          </div>
          <div id="js-results-container" class="search-results-list" style="display:none;"></div>
        </div>
      </div>
    </div>
  </div>
</div>


  
  <main class="content" aria-label="Content">
    




<div class="container">
  <div class="row">
    <div class="col col-12">
      <div class="image-box">
        <img class="post-image" src="http://twcch.io/images/post/common/data_science_competition_01.png" alt="(Day 6) 邏輯迴歸 (多項式 &#43; 正規化)">
      </div>
    </div>
  </div>
</div>


<div class="container">

  <div class="row">
    <div class="col col-8 col-d-10 push-2 push-d-1 col-t-12 push-t-0">
    
      
      <article class="post amimate">

        <div class="post__head">
          
          <div class="post__tags">
            
            <a href="http://twcch.io/tags/data-science/" class="post-tags__tag">Data Science</a>
            
            <a href="http://twcch.io/tags/ithome-%E9%90%B5%E4%BA%BA%E8%B3%BD-2025/" class="post-tags__tag">IThome 鐵人賽 2025</a>
            
            <a href="http://twcch.io/tags/30-%E5%A4%A9%E5%85%A5%E9%96%80%E5%B8%B8%E8%A6%8B%E7%9A%84%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%BC%94%E7%AE%97%E6%B3%95/" class="post-tags__tag">30 天入門常見的機器學習演算法</a>
            
          </div>
          

          <h1 class="post__title">(Day 6) 邏輯迴歸 (多項式 &#43; 正規化)</h1>

          <div class="post__meta">
            <div class="post__author">
              <a href="/about/" class="post__author-image" style="background-image: url('http://twcch.io/images/avatar.jpg')" aria-label="謝志謙's Picture"></a> <a href="/about/" class="post__author-link">謝志謙</a>
            </div>
            <span class="post__date">
              <time datetime=" 2025-08-04T00:00:00&#43;08:00">Aug 4, 2025</time>
            </span>
          </div>

        </div>
    
        <div class="post__content">
          <p>在上一篇中，我們深入介紹了邏輯迴歸的模型邏輯、損失函數與分類行為。這篇則要進一步延伸這個經典模型，回答一個關鍵問題: 邏輯迴歸能否結合多項式特徵與正規化機制，來對抗非線性與過擬合問題?</p>
<p>在實務中，這樣的需求非常常見，但你可能很少看到「多項式邏輯迴歸」或「正規化邏輯迴歸」這樣的說法。雖然命名不常見，但本質上邏輯迴歸完全可以與這兩個技巧結合使用，而且這種搭配在複雜資料下是極具威力的實務技巧。</p>
<h2 id="為什麼邏輯迴歸可以搭配多項式與正規化">為什麼邏輯迴歸可以搭配多項式與正規化?</h2>
<h3 id="邏輯迴歸其實是線性模型">邏輯迴歸其實是線性模型</h3>
<p>邏輯迴歸雖然應用在分類任務f，但本質仍是一種「線性模型」:</p>
<p>$$
\hat{y} = \sigma(\beta_0 + \mathbf{x}^\top \boldsymbol{\beta})
$$</p>
<p>這表示它只能建構一條線性的 decision boundary。當你的資料本身具有非線性邊界時，例如 XOR 類型的資料，這條邏輯迴歸線就顯得力不從心。</p>
<p>解法之一，就是在原始特徵上做多項式擴展 (Polynomial Feature Expansion)——也就是增加特徵空間的非線性組合，例如 $x_1^2$、$x_1 \cdot x_2$ 等，來幫助模型在更高維度中建立線性可分的邊界。</p>
<p>這與之前我們在線性迴歸所談的邏輯迴歸原理一樣，只是這次應用在分類問題中。</p>
<h3 id="邏輯迴歸也容易過擬合">邏輯迴歸也容易過擬合</h3>
<p>一旦你使用多項式特徵，特徵數暴增，就可能發生過擬合，這時就需要正規化 (Regularization) 機制來抑制模型複雜度。</p>
<p>與 Linear Regression 一樣，邏輯迴歸可以透過 L1 或 L2 懲罰項達到正規化的目的:</p>
<ul>
<li>L2 (Ridge): 抑制權重值變得太大</li>
<li>L1 (Lasso): 推動部分權重變為 0，具有特徵選擇效果</li>
<li>Elastic Net: L1 + L2 混合調整</li>
</ul>
<p>值得注意的是，在 PyTorch 中，optimizer 的 weight_decay 只對應 L2，若要做 L1，則需自行加上額外的懲罰項。</p>
<h2 id="模型實作">模型實作</h2>
<p>這個案例也一樣，使用 PyTorch 來實現，透過這段程式碼來窺探 Logistic Regression 的細節。但是還是要再次聲明一下，不論是機器學習演算法，還是說什麼排序的那些算法，你自己寫的打概率打不過這種主流套件做出來的方法，因為這些方法可能經過 10 幾年以上的迭代，不斷地維護與優化產生的，所以如果是學習的話可以自己做，但是正式要使用的話還是建議直接用這些現成的方法，表現往往更加優秀。</p>
<p>回到正題，如前面所說的，因為 Logistic Regression 是先使用 Linear Regression 方程式預測出一個結果，再藉由 Sigmoid 函數逕行轉換。以下是用單層神經網絡，來模擬 Logistic Regression 的演算法，所以只定義 output layer 為線性輸出層 + Sigmoid function。</p>
<p>這段程式碼跟昨天的沒有太大的區別，所以只挑重點說明，上半部就是 PolynomialFeatures 處理的標準寫法，只是說這個案例還有對特徵做 Rescaling，所以會把 PolynomialFeatures 輸出的結果再放到 StandardScaler 去處理。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X_train_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">X_train_scaler</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_poly</span><span class="p">)</span>
</span></span></code></pre></div><p>這段比較特別的地方是，增加 weight_decay 參數，這個參數就是 SGD 用來實作 L2 Regularization 的機制，至於傳入的數值就是只正規化的 $\lambda$，這個值沒有固定標準，它是個超參數，必須根據實驗調整，這邊就只是用 0.1 做示範。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="完整程式碼">完整程式碼</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span><span class="p">,</span> <span class="n">StandardScaler</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 資料產生與前處理</span>
</span></span><span class="line"><span class="cl"><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X_train_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">X_train_scaler</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_poly</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 轉換為 tensor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">X_train_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_train_scaler</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y_train_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 模型定義</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LogisticRegressionModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">(</span><span class="n">LogisticRegressionModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>  <span class="c1"># 1 個輸出 (sigmoid 之前)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegressionModel</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">X_train_poly</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 設定 criterion 與 optimizer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># weight_decay 是用來實作 L2 Regularization 的機制</span>
</span></span><span class="line"><span class="cl"><span class="c1"># PyTorch 的 optim.SGD、optim.Adam 等 optimizer 本身沒有原生支援 L1 regularization 的核心原因在於以下三點:</span>
</span></span><span class="line"><span class="cl"><span class="c1">## L1 不是 differentiable everywhere (在零點不可微)</span>
</span></span><span class="line"><span class="cl"><span class="c1">## PyTorch 的 weight_decay 設計僅對應 L2 (即 Ridge)</span>
</span></span><span class="line"><span class="cl"><span class="c1">## L1 實作需要手動處理梯度</span>
</span></span><span class="line"><span class="cl"><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 訓練</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>  <span class="c1"># 告訴模型進入: 訓練模式</span>
</span></span><span class="line"><span class="cl">    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>  <span class="c1"># 梯度歸零，預設梯度是累加的 (accumulated)，必須在每一回合開始前清空上一輪的梯度，否則梯度會疊加，導致錯誤的參數更新</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train_tensor</span><span class="p">)</span>  <span class="c1"># 前向傳播 (forward pass)</span>
</span></span><span class="line"><span class="cl">    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_train_tensor</span><span class="p">)</span>  <span class="c1"># 使用定義好的損失函數來計算預測值和真實標籤之間的損失</span>
</span></span><span class="line"><span class="cl">    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>  <span class="c1"># 反向傳播 (Backward Pass)，這些梯度會儲存在每個參數的 .grad 屬性中</span>
</span></span><span class="line"><span class="cl">    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>  <span class="c1"># 根據梯度更新模型參數</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n_epochs</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 預測</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">X_test_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X_test_scaler</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_poly</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X_test_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_scaler</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y_test_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>  <span class="c1"># 停用自動微分 (autograd)，不會追蹤張量的計算圖，減少記憶體消耗與加速推論，是測試與部署時的必備寫法，訓練需要追蹤梯度，測試不需要，這行就是明確告訴 PyTorch「這是測試」</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 預測機率</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_train_prob</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train_tensor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_test_prob</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_test_tensor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_train_prob</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_test_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_test_prob</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 評估</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[Train Accuracy] </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[Test Accuracy] </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">))</span>
</span></span></code></pre></div><h3 id="執行結果">執行結果</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[Train Accuracy] 0.87
</span></span><span class="line"><span class="cl">              precision    recall  f1-score   support
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           0       0.86      0.87      0.87     40060
</span></span><span class="line"><span class="cl">           1       0.87      0.86      0.86     39940
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    accuracy                           0.87     80000
</span></span><span class="line"><span class="cl">   macro avg       0.87      0.87      0.87     80000
</span></span><span class="line"><span class="cl">weighted avg       0.87      0.87      0.87     80000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[Test Accuracy] 0.86
</span></span><span class="line"><span class="cl">              precision    recall  f1-score   support
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           0       0.86      0.87      0.86      9954
</span></span><span class="line"><span class="cl">           1       0.87      0.86      0.86     10046
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    accuracy                           0.86     20000
</span></span><span class="line"><span class="cl">   macro avg       0.86      0.86      0.86     20000
</span></span><span class="line"><span class="cl">weighted avg       0.86      0.86      0.86     20000
</span></span></code></pre></div><h4 id="結果評估">結果評估</h4>
<p>這篇就不做結果分析，因為這個案例當初沒有設計好，就直接使用 make_classification() 生成的資料，實際跑起來就會發現跟昨天的結果沒有太大的區別，但這並不表示擴充特徵與正規化沒有價值，反而應該這樣解釋:</p>
<ul>
<li>本資料集本身就不難，線性模型已可擬合大部分樣本</li>
<li>多項式與正規化提升了模型的抗干擾性與穩定性</li>
<li>若資料更複雜、特徵更多 (如 100+)、樣本更雜，差異才會被放大</li>
</ul>
<h2 id="結語">結語</h2>
<p>Logistic Regression 是一個極為經典但常被低估的模型。很多人在初學時學過它，卻未曾真正理解它的潛力與可擴充性。</p>
<p>這篇的結論非常明確:</p>
<ul>
<li>邏輯迴歸可以處理非線性問題，只要你做了特徵轉換 (如 Polynomial Features)。</li>
<li>邏輯迴歸也可以加入正規化項，對抗高維資料的過擬合風險。</li>
<li>PyTorch 實作只需幾行調整，就能把這些進階能力加進來，落實在真實模型訓練中。</li>
</ul>
<p>或許在這個範例中，我們沒有看到明顯壓倒性的效能差距，但請記住:</p>
<ul>
<li>特徵擴展與正規化的真正價值，往往不是提升當下效能，而是「讓模型更穩定、可靠且可泛化」，這對實務來說，甚至比準確率還更關鍵。</li>
</ul>
<p>這也呼應了一個核心理念: 模型不是越複雜越好，而是越穩定、越能抵抗資料波動才是真本事。</p>
<h2 id="備註">備註</h2>
<ul>
<li>同步發表於 <a href="https://ithelp.ithome.com.tw/users/20163705/ironman/8136">iThome 鐵人賽 2025 - 30 天入門常見的機器學習演算法</a></li>
</ul>

        </div>
    
        <div class="post__share">
  <div class="share__head">
    <div class="share__title">Share this article</div>
  </div>
  <ul class="share__list list-reset">
    <li class="share__item">
      <a class="share__link share__facebook" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2ftwcch.io%2fposts%2fcolumn_article%2fironman_2025_30%25E5%25A4%25A9%25E5%2585%25A5%25E9%2596%2580%25E5%25B8%25B8%25E8%25A6%258B%25E7%259A%2584%25E6%25A9%259F%25E5%2599%25A8%25E5%25AD%25B8%25E7%25BF%2592%25E6%25BC%2594%25E7%25AE%2597%25E6%25B3%2595%2farticles_25080401%2f"
        onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
        title="Share on Facebook" rel="nofollow"><i class="ion ion-logo-facebook"></i></a>
    </li>
    <li class="share__item">
      <a class="share__link share__twitter" href="https://twitter.com/intent/tweet?text=%28Day%206%29%20%e9%82%8f%e8%bc%af%e8%bf%b4%e6%ad%b8%20%28%e5%a4%9a%e9%a0%85%e5%bc%8f%20%2b%20%e6%ad%a3%e8%a6%8f%e5%8c%96%29&url=http%3a%2f%2ftwcch.io%2fposts%2fcolumn_article%2fironman_2025_30%25E5%25A4%25A9%25E5%2585%25A5%25E9%2596%2580%25E5%25B8%25B8%25E8%25A6%258B%25E7%259A%2584%25E6%25A9%259F%25E5%2599%25A8%25E5%25AD%25B8%25E7%25BF%2592%25E6%25BC%2594%25E7%25AE%2597%25E6%25B3%2595%2farticles_25080401%2f" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" rel="nofollow"><i class="ion ion-logo-twitter"></i></a>
    </li>

    <li class="share__item">
      <a class="share__link share__linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2ftwcch.io%2fposts%2fcolumn_article%2fironman_2025_30%25E5%25A4%25A9%25E5%2585%25A5%25E9%2596%2580%25E5%25B8%25B8%25E8%25A6%258B%25E7%259A%2584%25E6%25A9%259F%25E5%2599%25A8%25E5%25AD%25B8%25E7%25BF%2592%25E6%25BC%2594%25E7%25AE%2597%25E6%25B3%2595%2farticles_25080401%2f&title=%28Day%206%29%20%e9%82%8f%e8%bc%af%e8%bf%b4%e6%ad%b8%20%28%e5%a4%9a%e9%a0%85%e5%bc%8f%20%2b%20%e6%ad%a3%e8%a6%8f%e5%8c%96%29&summary=&source=%28Day%206%29%20%e9%82%8f%e8%bc%af%e8%bf%b4%e6%ad%b8%20%28%e5%a4%9a%e9%a0%85%e5%bc%8f%20%2b%20%e6%ad%a3%e8%a6%8f%e5%8c%96%29"
      onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" rel="nofollow"><i class="ion ion-logo-linkedin"></i></a>
    </li>

    <li class="share__item">
      <a class="share__link share__pinterest"
        href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2ftwcch.io%2fposts%2fcolumn_article%2fironman_2025_30%25E5%25A4%25A9%25E5%2585%25A5%25E9%2596%2580%25E5%25B8%25B8%25E8%25A6%258B%25E7%259A%2584%25E6%25A9%259F%25E5%2599%25A8%25E5%25AD%25B8%25E7%25BF%2592%25E6%25BC%2594%25E7%25AE%2597%25E6%25B3%2595%2farticles_25080401%2f&amp;media=http%3a%2f%2ftwcch.io%2fimages%2fpost%2fcommon%2fdata_science_competition_01.png&amp;description=%28Day%206%29%20%e9%82%8f%e8%bc%af%e8%bf%b4%e6%ad%b8%20%28%e5%a4%9a%e9%a0%85%e5%bc%8f%20%2b%20%e6%ad%a3%e8%a6%8f%e5%8c%96%29"
        onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
        title="Share on Pinterest" aria-label="Share on Pinterest"><i class="ion ion-logo-pinterest"></i></a>
    </li>
  </ul>
</div>

        
        <div class="post__navigation">
          
          <a class="prev" href="http://twcch.io/posts/column_article/ironman_2025_30%E5%A4%A9%E5%85%A5%E9%96%80%E5%B8%B8%E8%A6%8B%E7%9A%84%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%BC%94%E7%AE%97%E6%B3%95/articles_25080501/" style="background-image: url('./images/post/common/data_science_competition_01.png')">
            <div class="post__nav-box">
              <div class="post__nav post__nav__prev"><i class="ion ion-ios-arrow-back"></i> Previous
                Page</div>
              <h4 class="post__nav__title">(Day 7) 回顧迴歸：從線性邏輯到學習本質</h4>
            </div>
          </a>
          
          
        </div>
        

        
          
<div id="disqus_thread" class="post__comments">
  <div id="disqus_empty"></div>
</div>

<script>
  function load_disqus() {
    var disqus_shortname = 'anvod-studio-aditu',
      is_disqus_empty = document.getElementById('disqus_empty'),
      disqus_target = document.getElementById('disqus_thread'),
      disqus_embed = document.createElement('script'),
      disqus_hook = (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]);

    if (disqus_target && is_disqus_empty) {
      disqus_embed.type = 'text/javascript';
      disqus_embed.async = true;
      disqus_embed.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      disqus_hook.appendChild(disqus_embed);
      is_disqus_empty.remove();
    }
  }

  window.addEventListener('scroll', function (e) {
    var currentScroll = document.scrollingElement.scrollTop;
    var disqus_target = document.getElementById('disqus_thread');

    if (disqus_target && (currentScroll > disqus_target.getBoundingClientRect().top - 150)) {
      load_disqus('disqus_shortname');
    }
  }, false);

</script>
<noscript>Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>

        
    
      </article>
      
    </div>
  </div>


</div>




  </main>
  

  <div class="top" title="Top"><i class="ion ion-ios-arrow-up"></i></div>

  




<footer class="footer">

  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="footer__inner">
          

<div class="social">
  <ul class="social__list list-reset">
    
    <li class="social__item">
      <a class="social__link" href="https://github.com/twcch" target="_blank" rel="noopener"
        aria-label="Github link"><i class="ion ion-logo-github"></i></a>
    </li>
    
  </ul>
</div>


          <div class="copyright">
            &copy; 2020–2025 <a href="/">志謙&#39;s Blog</a>.
             
          </div>
        </div>
      </div>
    </div>
  </div>

</footer>


  


<script src="/js/scripts.min.0a3f16199071420ff4ff1b00d3a17a82da5457f6cc2e1911abcf6af3455175e1.js"></script>
<script src="/js/common.min.97bf160adbcbe9b0d5bd37c5aa39cb5f1f3a88050b81463847425ffb0387d33e.js"></script>

</body>

</html>