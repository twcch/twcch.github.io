<!DOCTYPE html>
<html lang="zh-tw">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">

  <title>(Day 2) 線性迴歸 (Linear Regression) | 志謙&#39;s Blog</title>

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="..." crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="..." crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="..." crossorigin="anonymous"
  onload="renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false}
    ]
  });"></script>

  <meta name="description" content="">

  

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="(Day 2) 線性迴歸 (Linear Regression) | 志謙&#39;s Blog">
  <meta name="twitter:description" content="線性迴歸 (Linear Regression) 是統計學中的一種預測方法，主要分為簡單線性迴歸 (Simple Linear Regression) 與多元線性迴歸 (Multiple Linear Regression)，又稱複迴歸，以及其他變形的迴歸等，但在線性迴歸中，通常會有 1~N 個自變數 (Independent Variable) X，也可以稱作特徵 (Feature)；和 1 個因變數 (Dependent Variable) Y，也可以稱作目標 (Target)。而最終目的就是找出一條最佳迴歸線，來擬合這些數據點，便可以用來預測未來的數據點。
模型介紹
模型邏輯與核心概念
線性迴歸假設
統計學線性迴歸的經典的五大假設:

線性關係: 自變數與因變數之間存在線性關係
誤差項獨立 (Independence): 誤差項之間沒有相互關係
同標準差性 (Homoscedasticity): 對於所有的自變數，誤差項具有相同的標準差
誤差項常態性 (Normality of Errors): 誤差項應該成常態分佈
高度共線性 (Multicollinearity): 自變數間高度線性相關

看到這邊會想說，為什麼要特別註明統計學? 跟機器學習無關? 先記住一句話「統計學重推論，機器學習重預測」，很多假設跟機器學習中的線性迴歸模型還真的沒有太大的關係，但是也不代表，機器學習模型完全沒有假設，但是相對比較不重要，這也是為什麼很多仿間的機器學習教材都會忽略假設這塊。
總而言之，機器學習模型不像統計學模型需要那麼嚴謹的假設，但是若違反某些假設，也是會影響機器學習模型的表現，也會使得模型只能用於預測，無法用於推論，以下簡單整理假設對統計模型與機器學習模型的影響:

  
      
          假設
          對傳統統計模型影響
          對機器學習影響
          建議處理方式
      
  
  
      
          線性關係
          ✅ 極高 (核心假設)
          ❌ 可忽略 (可透過特徵轉換處理)
          用非線性模型 / 特徵轉換
      
      
          誤差獨立性
          ✅ 高 (推論與解釋需此條件支持)
          ✅ 高 (對 generalization 有直接影響)
          使用適當資料分割策略
      
      
          同變異性
          ✅ 中高 (影響參數估計的信度)
          ❌ 可忽略 (模型的估計值仍然準，但 p-value、CI 失真)
          變數轉換、加權最小平方法
      
      
          誤差常態性
          ✅ 中高 (特定推論工具須常態性支持)
          ❌ 可忽略
          若僅做預測可忽略
      
      
          共線性
          ✅ 高 (嚴重影響模型可解釋性與推論)
          ❌ 可忽略 (但建議修正以利解釋)
          VIF、降維、正則化
      
  

運作原理
我們先回到線性迴歸的用途與目的，簡單來說就是「找出一條最佳直線，來擬合這些數據點，便可以用來預測未來的數據點」，如何找出最佳直線? 本文會簡單的介紹一下，詳細過程與原理，再請讀者自行尋找其他資源暸解。">
  <meta name="twitter:image" content="http://twcch.io/images/post/common/data_science_competition_01.png">

  
  <meta property="og:title" content="(Day 2) 線性迴歸 (Linear Regression) | 志謙&#39;s Blog">
  <meta property="og:description" content="線性迴歸 (Linear Regression) 是統計學中的一種預測方法，主要分為簡單線性迴歸 (Simple Linear Regression) 與多元線性迴歸 (Multiple Linear Regression)，又稱複迴歸，以及其他變形的迴歸等，但在線性迴歸中，通常會有 1~N 個自變數 (Independent Variable) X，也可以稱作特徵 (Feature)；和 1 個因變數 (Dependent Variable) Y，也可以稱作目標 (Target)。而最終目的就是找出一條最佳迴歸線，來擬合這些數據點，便可以用來預測未來的數據點。
模型介紹
模型邏輯與核心概念
線性迴歸假設
統計學線性迴歸的經典的五大假設:

線性關係: 自變數與因變數之間存在線性關係
誤差項獨立 (Independence): 誤差項之間沒有相互關係
同標準差性 (Homoscedasticity): 對於所有的自變數，誤差項具有相同的標準差
誤差項常態性 (Normality of Errors): 誤差項應該成常態分佈
高度共線性 (Multicollinearity): 自變數間高度線性相關

看到這邊會想說，為什麼要特別註明統計學? 跟機器學習無關? 先記住一句話「統計學重推論，機器學習重預測」，很多假設跟機器學習中的線性迴歸模型還真的沒有太大的關係，但是也不代表，機器學習模型完全沒有假設，但是相對比較不重要，這也是為什麼很多仿間的機器學習教材都會忽略假設這塊。
總而言之，機器學習模型不像統計學模型需要那麼嚴謹的假設，但是若違反某些假設，也是會影響機器學習模型的表現，也會使得模型只能用於預測，無法用於推論，以下簡單整理假設對統計模型與機器學習模型的影響:

  
      
          假設
          對傳統統計模型影響
          對機器學習影響
          建議處理方式
      
  
  
      
          線性關係
          ✅ 極高 (核心假設)
          ❌ 可忽略 (可透過特徵轉換處理)
          用非線性模型 / 特徵轉換
      
      
          誤差獨立性
          ✅ 高 (推論與解釋需此條件支持)
          ✅ 高 (對 generalization 有直接影響)
          使用適當資料分割策略
      
      
          同變異性
          ✅ 中高 (影響參數估計的信度)
          ❌ 可忽略 (模型的估計值仍然準，但 p-value、CI 失真)
          變數轉換、加權最小平方法
      
      
          誤差常態性
          ✅ 中高 (特定推論工具須常態性支持)
          ❌ 可忽略
          若僅做預測可忽略
      
      
          共線性
          ✅ 高 (嚴重影響模型可解釋性與推論)
          ❌ 可忽略 (但建議修正以利解釋)
          VIF、降維、正則化
      
  

運作原理
我們先回到線性迴歸的用途與目的，簡單來說就是「找出一條最佳直線，來擬合這些數據點，便可以用來預測未來的數據點」，如何找出最佳直線? 本文會簡單的介紹一下，詳細過程與原理，再請讀者自行尋找其他資源暸解。">
  <meta property="og:image" content="http://twcch.io/images/post/common/data_science_competition_01.png">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,600%7CPoppins:400,600,700&display=swap" as="style">
  <link href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,600%7CPoppins:400,600,700&display=swap" rel="stylesheet">

  
  <link rel="preload" href="https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css" as="style">
  <link href="https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css" rel="stylesheet">

  
  
  <style>/*!------------------------------------------------------------------
[MAIN STYLESHEET]
-------------------------------------------------------------------*/.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.show{display:block}.hide{display:none}.invisible{visibility:hidden}.list-reset{list-style-type:none;margin:0;padding:0}.clearfix::after,.clearfix ::before{content:"";display:table;clear:both}.screen-reader-text{clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;position:absolute!important;width:1px;word-wrap:normal!important}/*!normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css*/html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,dl,dd,ol,ul,fieldset,legend,figure,hr{margin:0;padding:0}li>ul,li>ol{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}h1,h2,h3,h4,h5,h6,ul,ol,dl,blockquote,p,address,hr,table,fieldset,figure,pre{margin-bottom:30px}ul,ol,dd{margin-left:20px}.highlight{color:#fff;background:#0a0a12}.highlighter-rouge .highlight{background:#eef}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:700}.highlight .o{font-weight:700}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:700}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:700;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:700}.highlight .gu{color:#fff}.highlight .gt{color:#a00}.highlight .kc{font-weight:700}.highlight .kd{font-weight:700}.highlight .kp{font-weight:700}.highlight .kr{font-weight:700}.highlight .kt{color:#458;font-weight:700}.highlight .m{color:#099}.highlight .s{color:#e03460}.highlight .na{color:teal}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:700}.highlight .no{color:teal}.highlight .ni{color:purple}.highlight .ne{color:#900;font-weight:700}.highlight .nf{color:#900;font-weight:700}.highlight .nn{color:#555}.highlight .nt{color:#6565ff}.highlight .nv{color:teal}.highlight .ow{font-weight:700}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#e03460}.highlight .sc{color:#e03460}.highlight .sd{color:#e03460}.highlight .s2{color:#e03460}.highlight .se{color:#e03460}.highlight .sh{color:#e03460}.highlight .si{color:#e03460}.highlight .sx{color:#e03460}.highlight .sr{color:#009926}.highlight .s1{color:#e03460}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:teal}.highlight .vg{color:teal}.highlight .vi{color:teal}.highlight .il{color:#099}.container{max-width:1300px;padding-left:20px;padding-right:20px;margin:0 auto}.container-big{max-width:1600px;padding-left:20px;padding-right:20px;margin:0 auto}.row{display:flex;flex-wrap:wrap;flex:initial;flex-direction:row;box-sizing:border-box;margin-left:-15px;margin-right:-15px}.col{padding-left:15px;padding-right:15px}[class^=col-]{flex:auto}.col-0{width:0%}.col-1{width:8.33333333%}.col-2{width:16.66666667%}.col-3{width:25%}.col-4{width:33.33333333%}.col-5{width:41.66666667%}.col-6{width:50%}.col-7{width:58.33333333%}.col-8{width:66.66666667%}.col-9{width:75%}.col-10{width:83.33333333%}.col-11{width:91.66666667%}.col-12{width:100%}.push-0{margin-left:0%}.push-1{margin-left:8.33333333%}.push-2{margin-left:16.66666667%}.push-3{margin-left:25%}.push-4{margin-left:33.33333333%}.push-5{margin-left:41.66666667%}.push-6{margin-left:50%}.push-7{margin-left:58.33333333%}.push-8{margin-left:66.66666667%}.push-9{margin-left:75%}.push-10{margin-left:83.33333333%}.push-11{margin-left:91.66666667%}.push-12{margin-left:100%}.pull-0{margin-right:0%}.pull-1{margin-right:8.33333333%}.pull-2{margin-right:16.66666667%}.pull-3{margin-right:25%}.pull-4{margin-right:33.33333333%}.pull-5{margin-right:41.66666667%}.pull-6{margin-right:50%}.pull-7{margin-right:58.33333333%}.pull-8{margin-right:66.66666667%}.pull-9{margin-right:75%}.pull-10{margin-right:83.33333333%}.pull-11{margin-right:91.66666667%}.pull-12{margin-right:100%}@media(max-width:992px){.col-d-0{width:0%}.col-d-1{width:8.33333333%}.col-d-2{width:16.66666667%}.col-d-3{width:25%}.col-d-4{width:33.33333333%}.col-d-5{width:41.66666667%}.col-d-6{width:50%}.col-d-7{width:58.33333333%}.col-d-8{width:66.66666667%}.col-d-9{width:75%}.col-d-10{width:83.33333333%}.col-d-11{width:91.66666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.33333333%}.push-d-2{margin-left:16.66666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.33333333%}.push-d-5{margin-left:41.66666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.33333333%}.push-d-8{margin-left:66.66666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.33333333%}.push-d-11{margin-left:91.66666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.33333333%}.pull-d-2{margin-right:16.66666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.33333333%}.pull-d-5{margin-right:41.66666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.33333333%}.pull-d-8{margin-right:66.66666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.33333333%}.pull-d-11{margin-right:91.66666667%}.pull-d-12{margin-right:100%}}@media(max-width:768px){.col-t-0{width:0%}.col-t-1{width:8.33333333%}.col-t-2{width:16.66666667%}.col-t-3{width:25%}.col-t-4{width:33.33333333%}.col-t-5{width:41.66666667%}.col-t-6{width:50%}.col-t-7{width:58.33333333%}.col-t-8{width:66.66666667%}.col-t-9{width:75%}.col-t-10{width:83.33333333%}.col-t-11{width:91.66666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.33333333%}.push-t-2{margin-left:16.66666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.33333333%}.push-t-5{margin-left:41.66666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.33333333%}.push-t-8{margin-left:66.66666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.33333333%}.push-t-11{margin-left:91.66666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.33333333%}.pull-t-2{margin-right:16.66666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.33333333%}.pull-t-5{margin-right:41.66666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.33333333%}.pull-t-8{margin-right:66.66666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.33333333%}.pull-t-11{margin-right:91.66666667%}.pull-t-12{margin-right:100%}}@media(max-width:576px){.col-m-0{width:0%}.col-m-1{width:8.33333333%}.col-m-2{width:16.66666667%}.col-m-3{width:25%}.col-m-4{width:33.33333333%}.col-m-5{width:41.66666667%}.col-m-6{width:50%}.col-m-7{width:58.33333333%}.col-m-8{width:66.66666667%}.col-m-9{width:75%}.col-m-10{width:83.33333333%}.col-m-11{width:91.66666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.33333333%}.push-m-2{margin-left:16.66666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.33333333%}.push-m-5{margin-left:41.66666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.33333333%}.push-m-8{margin-left:66.66666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.33333333%}.push-m-11{margin-left:91.66666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.33333333%}.pull-m-2{margin-right:16.66666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.33333333%}.pull-m-5{margin-right:41.66666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.33333333%}.pull-m-8{margin-right:66.66666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.33333333%}.pull-m-11{margin-right:91.66666667%}.pull-m-12{margin-right:100%}}@media(max-width:992px){.col-d-0{width:0%}.col-d-1{width:8.33333333%}.col-d-2{width:16.66666667%}.col-d-3{width:25%}.col-d-4{width:33.33333333%}.col-d-5{width:41.66666667%}.col-d-6{width:50%}.col-d-7{width:58.33333333%}.col-d-8{width:66.66666667%}.col-d-9{width:75%}.col-d-10{width:83.33333333%}.col-d-11{width:91.66666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.33333333%}.push-d-2{margin-left:16.66666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.33333333%}.push-d-5{margin-left:41.66666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.33333333%}.push-d-8{margin-left:66.66666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.33333333%}.push-d-11{margin-left:91.66666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.33333333%}.pull-d-2{margin-right:16.66666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.33333333%}.pull-d-5{margin-right:41.66666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.33333333%}.pull-d-8{margin-right:66.66666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.33333333%}.pull-d-11{margin-right:91.66666667%}.pull-d-12{margin-right:100%}}@media(max-width:768px){.col-t-0{width:0%}.col-t-1{width:8.33333333%}.col-t-2{width:16.66666667%}.col-t-3{width:25%}.col-t-4{width:33.33333333%}.col-t-5{width:41.66666667%}.col-t-6{width:50%}.col-t-7{width:58.33333333%}.col-t-8{width:66.66666667%}.col-t-9{width:75%}.col-t-10{width:83.33333333%}.col-t-11{width:91.66666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.33333333%}.push-t-2{margin-left:16.66666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.33333333%}.push-t-5{margin-left:41.66666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.33333333%}.push-t-8{margin-left:66.66666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.33333333%}.push-t-11{margin-left:91.66666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.33333333%}.pull-t-2{margin-right:16.66666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.33333333%}.pull-t-5{margin-right:41.66666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.33333333%}.pull-t-8{margin-right:66.66666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.33333333%}.pull-t-11{margin-right:91.66666667%}.pull-t-12{margin-right:100%}}@media(max-width:576px){.col-m-0{width:0%}.col-m-1{width:8.33333333%}.col-m-2{width:16.66666667%}.col-m-3{width:25%}.col-m-4{width:33.33333333%}.col-m-5{width:41.66666667%}.col-m-6{width:50%}.col-m-7{width:58.33333333%}.col-m-8{width:66.66666667%}.col-m-9{width:75%}.col-m-10{width:83.33333333%}.col-m-11{width:91.66666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.33333333%}.push-m-2{margin-left:16.66666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.33333333%}.push-m-5{margin-left:41.66666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.33333333%}.push-m-8{margin-left:66.66666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.33333333%}.push-m-11{margin-left:91.66666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.33333333%}.pull-m-2{margin-right:16.66666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.33333333%}.pull-m-5{margin-right:41.66666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.33333333%}.pull-m-8{margin-right:66.66666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.33333333%}.pull-m-11{margin-right:91.66666667%}.pull-m-12{margin-right:100%}}@media(max-width:992px){.col-d-0{width:0%}.col-d-1{width:8.33333333%}.col-d-2{width:16.66666667%}.col-d-3{width:25%}.col-d-4{width:33.33333333%}.col-d-5{width:41.66666667%}.col-d-6{width:50%}.col-d-7{width:58.33333333%}.col-d-8{width:66.66666667%}.col-d-9{width:75%}.col-d-10{width:83.33333333%}.col-d-11{width:91.66666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.33333333%}.push-d-2{margin-left:16.66666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.33333333%}.push-d-5{margin-left:41.66666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.33333333%}.push-d-8{margin-left:66.66666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.33333333%}.push-d-11{margin-left:91.66666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.33333333%}.pull-d-2{margin-right:16.66666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.33333333%}.pull-d-5{margin-right:41.66666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.33333333%}.pull-d-8{margin-right:66.66666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.33333333%}.pull-d-11{margin-right:91.66666667%}.pull-d-12{margin-right:100%}}@media(max-width:768px){.col-t-0{width:0%}.col-t-1{width:8.33333333%}.col-t-2{width:16.66666667%}.col-t-3{width:25%}.col-t-4{width:33.33333333%}.col-t-5{width:41.66666667%}.col-t-6{width:50%}.col-t-7{width:58.33333333%}.col-t-8{width:66.66666667%}.col-t-9{width:75%}.col-t-10{width:83.33333333%}.col-t-11{width:91.66666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.33333333%}.push-t-2{margin-left:16.66666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.33333333%}.push-t-5{margin-left:41.66666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.33333333%}.push-t-8{margin-left:66.66666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.33333333%}.push-t-11{margin-left:91.66666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.33333333%}.pull-t-2{margin-right:16.66666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.33333333%}.pull-t-5{margin-right:41.66666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.33333333%}.pull-t-8{margin-right:66.66666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.33333333%}.pull-t-11{margin-right:91.66666667%}.pull-t-12{margin-right:100%}}@media(max-width:576px){.col-m-0{width:0%}.col-m-1{width:8.33333333%}.col-m-2{width:16.66666667%}.col-m-3{width:25%}.col-m-4{width:33.33333333%}.col-m-5{width:41.66666667%}.col-m-6{width:50%}.col-m-7{width:58.33333333%}.col-m-8{width:66.66666667%}.col-m-9{width:75%}.col-m-10{width:83.33333333%}.col-m-11{width:91.66666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.33333333%}.push-m-2{margin-left:16.66666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.33333333%}.push-m-5{margin-left:41.66666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.33333333%}.push-m-8{margin-left:66.66666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.33333333%}.push-m-11{margin-left:91.66666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.33333333%}.pull-m-2{margin-right:16.66666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.33333333%}.pull-m-5{margin-right:41.66666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.33333333%}.pull-m-8{margin-right:66.66666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.33333333%}.pull-m-11{margin-right:91.66666667%}.pull-m-12{margin-right:100%}}img[data-action=zoom]{cursor:pointer;cursor:-webkit-zoom-in;cursor:-moz-zoom-in}.zoom-img,.zoom-img-wrap{position:relative;z-index:666;-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}img.zoom-img{cursor:pointer;cursor:-webkit-zoom-out;cursor:-moz-zoom-out}.zoom-overlay{z-index:420;background:#16151f;position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;opacity:0;-webkit-transition:opacity 300ms;-o-transition:opacity 300ms;transition:opacity 300ms}@supports(-webkit-backdrop-filter:none) or (backdrop-filter:none){.zoom-overlay{-webkit-backdrop-filter:saturate(180%)blur(10px);backdrop-filter:saturate(180%)blur(10px);background:rgba(22,21,31,.8)}}.zoom-overlay-open .zoom-overlay{opacity:1}.zoom-overlay-open,.zoom-overlay-transitioning{cursor:default}.animate{animation:animateElement cubic-bezier(.3,.45,.45,.95).75s;animation-duration:.75s;animation-iteration-count:1;transition:transform .2s}@keyframes animateElement{0%{opacity:0;transform:translate(0,50px)}100%{opacity:1;transform:translate(0,0)}}*,*::after,*::before{box-sizing:border-box}body{font-family:josefin sans,sans-serif;font-size:18px;line-height:1.7;color:#fff;background-color:#16151f;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow-x:hidden}body.is-in::after{visibility:hidden;opacity:0;pointer-events:none}body::after{content:"";position:fixed;left:0;top:0;width:100%;height:100%;background-color:#0a0a12;z-index:999;transition:1s}body input,body textarea{border:1px solid #c6c6c6;outline:none}@media only screen and (max-width:576px){body{font-size:16px;line-height:29px}}::placeholder{color:#757575}*::selection{color:#fff;background-color:rgba(50,58,150,.7)}h1,h2,h3,h4,h5,h6{font-family:poppins,Arial,sans-serif;font-weight:700;line-height:1.4em;color:#fff}h1{font-size:36px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}blockquote{position:relative;padding:20px 20px 20px 45px;font-family:poppins,Arial,sans-serif;font-size:21px;line-height:37px;font-weight:700;color:#fff}blockquote:before{content:'\201C';position:absolute;font-family:poppins,Arial,sans-serif;top:.3em;left:-.01em;font-size:4em;color:rgba(255,255,255,.6)}blockquote cite{font-size:16px;font-style:normal;color:#fff}blockquote cite:before{content:'\2014' '\00a0'}@media only screen and (max-width:576px){blockquote{padding:20px 20px 20px 35px;font-size:18px;line-height:28px}}pre{overflow:auto;padding:15px;font-size:14px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}code[class*=language-],pre[class*=language-]{white-space:pre-wrap;word-break:break-all;line-height:inherit}img,.zoom-img-wrap{max-width:100%;height:auto;vertical-align:middle}img+em,.zoom-img-wrap+em{display:inline-block;width:100%;padding:13px;font-size:14px;font-style:normal;line-height:1;text-align:center;color:rgba(255,255,255,.8);background-color:#0a0a12}a{text-decoration:none;color:#fff;transition:all .2s}a:hover{color:#323a96}hr{display:block;width:100%;height:1px;margin:50px 0;border:0;background:rgba(255,255,255,.1)}.table-container{display:block;max-width:100%;overflow-x:auto}table{font-size:12px;color:rgba(255,255,255,.6);width:100%;border-width:1px;border-color:#0a0a12;border-collapse:collapse}table th{padding:10px;font-size:16px;text-align:left;border:1px solid #0a0a12;color:#fff;background-color:#323a96}table tr{background-color:#0a0a12;transition:all .3s ease}table tr:nth-child(even){background-color:transparent}table td{padding:10px;font-size:14px;border:1px solid #0a0a12}table tr:hover{color:#fff}.gallery-box{margin-bottom:30px}.gallery-box em{display:inline-block;width:100%;padding:13px;font-size:14px;font-style:normal;line-height:1;text-align:center;color:rgba(255,255,255,.8);background-color:#0a0a12}.gallery-box em a{text-decoration:underline;border-bottom:none}.gallery{display:grid;grid-template-columns:repeat(3,auto);justify-content:center;align-content:center;grid-gap:10px}.gallery img{width:100%;height:auto}.hero{position:relative;margin-bottom:30px;border-radius:30px;overflow:hidden;box-shadow:0 5px 10px rgba(0,0,0,.15);background-color:#0a0a12}@media only screen and (max-width:992px){.hero{border-radius:30px}}@media only screen and (max-width:576px){.hero{box-shadow:none}}.hero__inner::before{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;border-radius:30px;background-color:rgba(16,17,30,.6)}@media only screen and (max-width:992px){.hero__inner::before{border-radius:30px}}.hero__image{padding-top:50%;min-height:280px;user-select:none}.hero__image img{position:absolute;top:0;width:100%;height:100%;object-fit:cover}@media only screen and (max-width:992px){.hero__image{padding-top:55%}}@media only screen and (max-width:768px){.hero__image{padding-top:65%}}.hero__content{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;width:100%;max-width:650px;padding:0 20px;text-align:center}.hero__title{font-size:57px;margin:0 0 10px;color:#fff}@media only screen and (max-width:576px){.hero__title{font-size:43px;margin:0 0 5px}}.hero__desc{font-size:18px;color:rgba(255,255,255,.8);margin:0}@media only screen and (max-width:576px){.hero__desc{font-size:15px;line-height:21px}}.hero-without-image{margin:50px 0 80px}.hero-without-image .hero-inner{display:flex;align-items:center;justify-content:center}.hero-without-image .hero-content{width:100%;max-width:650px;padding:0 20px;text-align:center}@media only screen and (max-width:576px){.hero-without-image{margin:20px 0 50px}}.top{position:fixed;bottom:25px;right:-100px;z-index:5;width:40px;height:40px;line-height:40px;text-align:center;border-radius:5px;background-color:#0a0a12;color:#fff;cursor:pointer;transition:all .25s ease}.top.is-active{right:30px}@media only screen and (max-width:768px){.top{bottom:15px}.top.is-active{right:25px}}.header{width:100%;margin:35px 0;transition:all .2s;color:#fff}@media only screen and (max-width:992px){.header{margin:25px 0}}.header__inner{position:relative;display:flex;justify-content:space-between;align-items:center}.logo__link{font-family:poppins,Arial,sans-serif;font-size:27px;line-height:1;font-weight:700;vertical-align:middle;color:#fff;text-transform:uppercase;text-decoration:none;letter-spacing:2px;transition:none}.logo__link:hover{color:#fff}.logo__image{max-height:40px}.main-nav{width:100%;max-width:1300px;margin:0 auto}.main-nav__box{display:flex;align-items:center;width:80%;padding-top:200px;margin:0 auto}.main-nav__box .nav__icon-close{position:absolute;top:20px;right:40px;z-index:5;display:flex;align-items:center;justify-content:center;font-size:30px;width:40px;height:40px;text-align:center;line-height:40px;color:rgba(255,255,255,.5);transition:all .25s ease;cursor:pointer}.main-nav__box .nav__icon-close:hover{color:#fff}@media only screen and (max-width:768px){.main-nav__box{padding-top:100px}.main-nav__box .nav__icon-close{top:22px;right:42px}}@media only screen and (max-width:576px){.main-nav__box{width:90%}}.navigation{display:flex;align-items:center}.top-nav{margin-right:25px}.top-nav .nav__list .nav__item{display:inline-block;margin-right:25px}.top-nav .nav__list .nav__item:last-child{margin-right:0}.top-nav .nav__list .nav__item .nav__link{position:relative;font-size:16px;font-weight:400;text-decoration:none;color:#fff}.top-nav .nav__list .nav__item .nav__link:hover::before{opacity:1;visibility:visible}.top-nav .nav__list .nav__item .nav__link::before{content:"";position:absolute;left:50%;top:-15px;transform:translateX(-50%);display:block;width:7px;height:7px;border-radius:50%;transition:all .25s;opacity:0;visibility:hidden;background-color:#323a96}@media only screen and (max-width:992px){.top-nav{display:none}}.mobile-nav .nav__list .nav__item{display:block;margin-bottom:35px;text-align:center}.mobile-nav .nav__list .nav__item:last-child{margin-bottom:0}.mobile-nav .nav__list .nav__item .nav__link{position:relative;font-size:18px;color:#fff}@media only screen and (max-width:576px){.mobile-nav .nav__list .nav__item{margin-bottom:20px}}.nav-buttons{display:flex;align-items:center;font-size:24px;color:#fff}.nav-buttons .nav__icon-menu{display:none}@media only screen and (max-width:992px){.nav-buttons .nav__icon-menu{display:block}}.nav-buttons .nav__icon{cursor:pointer}.nav-buttons .nav__icon:first-child{margin-right:15px}.menu-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:-1;opacity:0;visibility:hidden;background-color:#0a0a12;transition:all .5s ease-in-out}.menu-overlay.is-open{z-index:100;opacity:1;visibility:visible}@supports(-webkit-backdrop-filter:none) or (backdrop-filter:none){.menu-overlay{-webkit-backdrop-filter:saturate(180%)blur(10px);backdrop-filter:saturate(180%)blur(10px);background-color:rgba(10,10,18,.9)}}@media only screen and (min-width:992px){.menu-overlay{display:none}}.nav-grid{width:100%;height:75vh;overflow-y:auto}.nav-grid__item{margin-bottom:30px}@media only screen and (max-width:768px){.nav-grid__item{height:auto}}.nav-grid__title{position:relative;margin-bottom:50px;padding-bottom:15px;font-size:30px;font-weight:700;text-align:center;color:#fff}.nav-grid__title::after{content:"";position:absolute;left:50%;bottom:0;transform:translate(-50%,-50%);display:block;width:25px;height:2px;background-color:#fff}@media only screen and (max-width:768px){.nav-grid__title{margin-bottom:30px}}.search{position:fixed;top:0;left:0;right:0;bottom:0;z-index:-1;opacity:0;visibility:hidden;background-color:#0a0a12;transition:all .5s ease-in-out}.search.is-visible{z-index:100;opacity:1;visibility:visible}@supports(-webkit-backdrop-filter:none) or (backdrop-filter:none){.search{-webkit-backdrop-filter:saturate(180%)blur(10px);backdrop-filter:saturate(180%)blur(10px);background-color:rgba(10,10,18,.9)}}.search__box{position:relative;max-width:650px;width:100%;margin:0 auto;padding-top:200px}.search__box .search__close{position:absolute;top:50%;right:20px;transform:translateY(-50%);font-size:30px;line-height:1;color:rgba(255,255,255,.5);transition:all .25s;cursor:pointer}.search__box .search__close:hover{color:#fff}@media only screen and (max-width:768px){.search__box{width:80%;padding-top:100px}}@media only screen and (max-width:576px){.search__box{width:90%}}.search__group{position:relative;margin-bottom:30px}.search__group .search__text{width:100%;height:auto;padding:15px 20px;font-family:poppins,Arial,sans-serif;font-size:28px;font-weight:700;line-height:42px;border-radius:5px;border:3px solid rgba(255,255,255,.5);transition:all .3s;color:#fff;background-color:transparent}.search__group .search__text::-webkit-input-placeholder{font-weight:700;color:rgba(255,255,255,.5)}.search__group .search__text::placeholder{font-weight:700;color:rgba(255,255,255,.5)}.search__group .search__text::-ms-clear{display:none}.search__group .search__text:focus{color:#fff;border-color:#323a96}@media only screen and (max-width:576px){.search__group .search__text{font-size:26px}}.search-results-list{height:55vh;padding:0 0 25px;list-style:circle;font-weight:700;color:#fff;overflow:auto;white-space:normal}.search-results-list .search-counter{margin-left:5px}.search-results-list .search-results__item{padding-bottom:15px;margin-bottom:15px;display:list-item;list-style-type:none;border-bottom:1px solid rgba(255,255,255,.1)}.search-results-list .search-results__link{position:relative;display:block;margin-left:-15px;padding-left:20px;font-size:18px;line-height:24px;font-weight:700;color:#fff;transition:all .25s ease-in-out}.search-results-list .search-results__link:hover{margin-left:15px}.search-results-list .search-results__link::before{content:"";position:absolute;top:6px;left:0;width:7px;height:7px;border-radius:50%;border:1px solid #fff}.search-results-list .search-results-date{font-size:12px;line-height:1;font-weight:400;color:rgba(255,255,255,.6)}.search-results-list .no-results{list-style:none}.search-results-list .no-results h3{font-size:18px}.load-more{margin:0 auto}.load-more-section{margin:30px auto;text-align:center}@media only screen and (max-width:576px){.load-more-section{margin:20px auto}}.load-more-posts i{margin-left:5px}.footer-widgets{padding:80px 0 30px;margin-top:20px;background-color:#0a0a12}.footer-widgets .row .col{flex-grow:1}.footer-widgets .row .col:last-child>.widget{padding-right:0}@media only screen and (max-width:768px){.footer-widgets{padding:80px 0 0}}@media only screen and (max-width:576px){.footer-widgets{padding:50px 0 0}}@media only screen and (max-width:768px){.widget{margin-bottom:60px}}.widget__title{position:relative;margin-bottom:20px;font-size:30px;line-height:1;color:#fff}@media only screen and (max-width:992px){.widget__title{font-size:24px}}.footer-logo{margin-bottom:20px;font-family:Poppins,Arial,sans-serif;font-size:27px;line-height:33px;font-weight:700;color:#fff;text-transform:uppercase;letter-spacing:2px;transition:none}.footer-desc{margin-bottom:0;font-size:16px;line-height:24px;color:rgba(255,255,255,.6)}.widget-nav{padding-right:30px}.widget-nav .nav__item{margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid rgba(255,255,255,.1)}.widget-nav .nav__item:last-child{margin-bottom:0}.widget-nav .nav__link{font-size:16px;color:#fff}@media only screen and (max-width:992px){.widget-nav{padding-right:0}}@media only screen and (max-width:768px){.widget-subscribe{margin-bottom:0}}.subscribe-subtitle{width:100%;margin-bottom:20px;font-size:16px;line-height:26px;color:rgba(255,255,255,.6)}@media only screen and (max-width:768px){.subscribe-subtitle{max-width:100%}}.subscribe-group-top{display:flex;align-items:center}.subscribe-group-top .subscribe-email{position:relative;width:100%;height:50px;padding:8px 15px;font-family:poppins,Arial,sans-serif;font-size:13px;border-radius:5px;line-height:50px;color:#0a0a12;background-color:#fff;border:1px solid #c6c6c6;outline:0;-webkit-appearance:none;box-sizing:border-box;transition:border-color .2s ease-in-out;cursor:text}.subscribe-group-top .subscribe-button{margin-left:10px}.footer{position:relative;padding:50px 0;background-color:#0a0a12}.footer .footer__inner{display:flex;justify-content:space-between;align-items:center}@media only screen and (max-width:768px){.footer .footer__inner{flex-direction:column;align-items:flex-start}}.copyright{font-size:13px;color:rgba(255,255,255,.6)}.copyright a{color:#fff}.social{text-align:center}.social .social__list{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.social .social__item{display:inline-block;margin-left:10px}.social .social__item:first-child{margin-left:0}.social .social__link{display:flex;justify-content:center;align-items:center;width:40px;height:40px;font-size:18px;line-height:40px;border-radius:3px;color:#fff;background-color:#16151f}.social .social__link:hover{background-color:#323a96}@media only screen and (max-width:992px){.social .social__link{width:30px;height:30px;line-height:30px;font-size:16px}}@media only screen and (max-width:768px){.social{margin-bottom:5px}.social .social__item{margin-bottom:10px}}.button{display:inline-block;white-space:nowrap;vertical-align:middle;font:inherit;border:none;border-radius:5px;outline:none;-webkit-appearance:none;text-align:center;text-decoration:none;color:#fff;transition:all .2s ease;cursor:pointer}.button:hover{color:#fff}.button--primary{padding:0 1.8rem;height:50px;font-size:16px;font-weight:600;line-height:50px;background-color:#323a96}.button--primary:hover{background-color:#2c3383}.button--middle{position:relative;height:60px;width:100%;max-width:280px;font-family:poppins,Arial,sans-serif;font-size:12px;line-height:60px;font-weight:600;letter-spacing:1px;text-transform:uppercase;transition:all .2s ease;background-color:#0a0a12}.button--middle:hover{background-color:#08080f}.button--small{height:28px;line-height:28px;display:inline-block;border-radius:30px;padding:0 15px;color:#fff;background-color:#323a96}.button--small:hover{background-color:#2c3383}.button--small::before{content:none!important}.button--big{display:block;width:100%}.article{align-items:stretch;flex-grow:1;min-height:380px;margin-bottom:30px}.article:hover{transform:translateY(-5px)}@media only screen and (max-width:576px){.article{min-height:280px}}.article__inner{position:relative;display:flex;width:100%;height:100%;border-radius:30px;overflow:hidden;box-shadow:0 5px 10px rgba(0,0,0,.15);background-color:#0a0a12}.article__inner .featured-post{position:absolute;top:0;right:0;z-index:10;width:35px;height:35px;display:flex;justify-content:center;align-items:center;font-size:18px;color:rgba(255,255,255,.8);user-select:none}.article__inner .featured-post::before{content:"";position:absolute;top:0;right:0;width:100%;height:100%;border-color:#323a96 #323a96 transparent transparent;border-style:solid;border-width:29px}.article__inner .featured-post i{position:relative}.article__title{margin:10px 0 15px;font-size:21px}.article__title a{color:#fff}@media only screen and (max-width:576px){.article__title{margin:5px 0 10px;font-size:18px}}.article__excerpt{margin-bottom:15px;font-size:15px;color:rgba(255,255,255,.6)}.article__excerpt p{margin:0}@media only screen and (max-width:576px){.article__excerpt{margin-bottom:10px;font-size:13px;line-height:21px}}.article__image{position:absolute;display:block;width:100%;height:100%;overflow:hidden;user-select:none;background-color:#0a0a12}.article__image::after{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(16,17,30,.6);pointer-events:none}.article__image img{position:absolute;top:0;width:100%;height:100%;object-fit:cover;pointer-events:none}@media only screen and (max-width:768px){.article__image{padding-top:75%}}@media only screen and (max-width:576px){.article__image{padding-top:80%}}.article__content{z-index:1;width:100%;margin-top:auto;padding:0 30px 30px}@media only screen and (max-width:576px){.article__content{padding:20px}}.article__meta{display:flex;align-items:center;flex-wrap:wrap;justify-content:flex-start;color:#fff}.article-tags{display:flex;flex-wrap:wrap;align-items:center}.article-tags__box{position:relative;display:flex;flex-wrap:wrap;align-items:center;line-height:1}.article-tags__box .article__tag{height:23px;padding:0 10px;margin:0 5px 5px 0;text-transform:uppercase;font-family:poppins,Arial,sans-serif;font-size:10px;line-height:23px;letter-spacing:1px;font-weight:700;border-radius:30px;color:rgba(255,255,255,.9);background-color:#323a96}.article-tags__box .article__tag:hover{background-color:#2c3383}.article-tags__box .article__tag:last-child{margin-right:0}@media only screen and (max-width:576px){.article-tags__box .article__tag{height:20px;line-height:20px}}.article__date{font-size:14px;color:#fff}.article__date::before{content:"";position:relative;bottom:.2rem;display:inline-block;height:3px;width:3px;margin:0 .5rem;border-radius:50%;background-color:rgba(255,255,255,.8)}@media only screen and (max-width:576px){.article__date{display:none}}.article__author{display:flex;align-items:center}.article__author-image{display:inline-block;width:25px;height:25px;margin-right:7px;border-radius:50%;border:1px solid rgba(255,255,255,.6);background-size:cover;background-position:50%;background-repeat:no-repeat;background-color:#0a0a12}.article__author-link{font-size:14px;text-decoration:underline;color:#fff}.article__author-link:hover{color:#fff}.article__author span{color:rgba(255,255,255,.8)}.post{position:relative;margin-bottom:30px}.post-image{position:absolute;top:0;width:100%;height:100%;object-fit:cover;user-select:none}.image-box{position:relative;padding-top:50%;min-height:280px;border-radius:30px;overflow:hidden;box-shadow:0 5px 10px rgba(0,0,0,.15);background-color:#0a0a12}@media only screen and (max-width:992px){.image-box{padding-top:55%}}@media only screen and (max-width:768px){.image-box{padding-top:65%}}.post__tags{position:relative;display:flex;justify-content:center;flex-wrap:wrap}.post__tags .post-tags__tag{height:23px;margin-right:5px;margin-bottom:5px;padding:0 10px;text-transform:uppercase;font-family:poppins,Arial,sans-serif;font-size:10px;line-height:23px;letter-spacing:1px;font-weight:700;border-radius:30px;color:rgba(255,255,255,.9);background-color:#323a96}.post__tags .post-tags__tag:hover{background-color:#2c3383}.post__tags .post-tags__tag:last-child{margin-right:0}@media only screen and (max-width:576px){.post__tags .post-tags__tag{height:20px;line-height:20px}}.post__head{margin:40px 0}.post__title{font-size:43px;margin:10px 0 15px;text-align:center}@media only screen and (max-width:768px){.post__title{font-size:38px}}@media only screen and (max-width:576px){.post__title{font-size:28px}}.post__meta{display:flex;align-items:center;flex-wrap:wrap;justify-content:center;color:#fff}.post__author{display:flex;align-items:center}.post__author-image{display:inline-block;width:25px;height:25px;margin-right:7px;border-radius:50%;border:1px solid rgba(255,255,255,.6);background-size:cover;background-position:50%;background-repeat:no-repeat;background-color:#0a0a12}.post__author-link{font-size:14px;text-decoration:underline;color:#fff}.post__author-link:hover{color:#fff}.post__author span{color:rgba(255,255,255,.8)}.post__date{font-size:14px;color:#fff}.post__date::before{content:"";position:relative;bottom:.2rem;display:inline-block;height:3px;width:3px;margin:0 .5rem;border-radius:50%;background-color:rgba(255,255,255,.8)}.post__content{color:rgba(255,255,255,.6)}.post__content a:hover{color:#fff;text-decoration:underline}.post__share{margin-bottom:80px}.post__share .share__head{text-align:center}.post__share .share__title{position:relative;display:inline-block;margin-bottom:25px;font-family:poppins,Arial,sans-serif;font-size:15px;font-weight:700;letter-spacing:1px;text-align:center;text-transform:uppercase}.post__share .share__list{display:flex;justify-content:center;align-items:center;width:100%}.post__share .share__item{margin:0 5px;text-align:center}.post__share .share__link{display:flex;justify-content:center;align-items:center;width:30px;height:30px;line-height:30px;border-radius:50%;font-size:16px;color:#0a0a12;background-color:#fff;transition:all .2s}.post__share .share__link:hover.share__facebook{color:#3b5998}.post__share .share__link:hover.share__twitter{color:#55acee}.post__share .share__link:hover.share__linkedin{color:#0077b5}.post__share .share__link:hover.share__pinterest{color:#bd081c}@media only screen and (max-width:576px){.post__share{margin-bottom:50px}}.post__navigation{display:flex;justify-content:space-between;margin-bottom:50px}.post__navigation a:first-child{margin-right:4%}.post__navigation a:last-child{margin-right:0}.post__navigation .prev,.post__navigation .next{position:relative;display:flex;align-items:flex-end;width:100%;min-height:230px;padding:0 25px 25px;border-radius:30px;overflow:hidden;transition:transform .2s,-webkit-transform .2s;box-shadow:0 5px 10px rgba(0,0,0,.15);background-size:cover;background-position:50%;background-repeat:no-repeat;background-color:#0a0a12}.post__navigation .prev::after,.post__navigation .next::after{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(16,17,30,.6);pointer-events:none}.post__navigation .prev:hover,.post__navigation .next:hover{transform:translateY(-5px)}.post__navigation .prev .post__nav,.post__navigation .next .post__nav{display:inline-block;margin-bottom:5px;font-size:13px;font-family:poppins,Arial,sans-serif;letter-spacing:1px;text-transform:uppercase;color:rgba(255,255,255,.8)}.post__navigation .prev .post__nav-box,.post__navigation .next .post__nav-box{position:relative;z-index:1;width:100%}.post__navigation .prev .post__nav__title,.post__navigation .next .post__nav__title{margin-bottom:0;font-size:21px}.post__navigation .prev .post__nav__title a,.post__navigation .next .post__nav__title a{color:#fff}.post__navigation .next{text-align:right;margin-left:auto}@media only screen and (max-width:768px){.post__navigation{flex-wrap:wrap}.post__navigation .prev,.post__navigation .next{width:100%}.post__navigation .prev{margin-bottom:20px}}.post__comments{margin-bottom:20px}.page{position:relative;margin-bottom:30px}.page__title{font-size:43px;margin-bottom:20px;text-align:center}@media only screen and (max-width:768px){.page__title{font-size:38px}}@media only screen and (max-width:768px){.page__title{font-size:28px}}.page-image{position:absolute;top:0;width:100%;height:100%;object-fit:cover;user-select:none}.image-box{position:relative;padding-top:50%;border-radius:30px;overflow:hidden;background-color:#0a0a12}@media only screen and (max-width:992px){.image-box{padding-top:55%}}@media only screen and (max-width:768px){.image-box{padding-top:65%}}.page__head{margin:40px 0}.page__content{color:rgba(255,255,255,.6)}.page__content a:hover{color:#fff;text-decoration:underline}.error{margin-bottom:0;text-align:center}.error .error__title{margin:24px 0;font-size:120px;line-height:1}.error .error__text{margin-bottom:48px;color:var(--text-alt-color)}@media only screen and (max-width:576px){.error .error__title{font-size:68px}.error .error__title{font-size:80px}.error .error__text{margin-bottom:24px}}.archive-box{position:relative;margin:50px 0 80px;text-align:center}@media only screen and (max-width:576px){.archive-box{margin:20px 0 50px}}.archive-counter{font-size:16px}.archive-title{position:relative;margin:0;font-size:47px;line-height:57px;text-transform:capitalize}@media only screen and (max-width:576px){.archive-title{font-size:40px;line-height:52px}}.form__group{margin-bottom:20px}.form__label{display:inline-block;margin-bottom:5px;font-family:poppins,Arial,sans-serif;font-size:14px;font-weight:600}.form__input{width:100%;padding:15px;font-family:poppins,Arial,sans-serif;font-size:14px;border-radius:5px}</style>
  

</head>

<body>

  

  
<header class="header">
  <div class="container">
    <div class="row">
      <div class="header__inner col col-12">

        <div class="logo">
          <a class="logo__link" href="http://twcch.io/">
            
              志謙&#39;s Blog
            
          </a>
        </div>

        <div class="menu-overlay">
          <nav class="main-nav">
            <div class="main-nav__box">
              <div class="nav__icon-close">
                <i class="ion ion-md-close"></i>
              </div>
              <div class="nav-grid">
                <div class="nav-grid__item">
                  <h2 class="nav-grid__title">Menu</h2>
                  <div class="mobile-nav">
                    <ul class="nav__list list-reset">
                      
                      <li class="nav__item">
                        <a href="/" class="nav__link">首頁</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/about" class="nav__link">關於我</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/tags/project" class="nav__link">個人專案</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/tags/ithome-%E9%90%B5%E4%BA%BA%E8%B3%BD-2025" class="nav__link">iThome 鐵人賽 2025 專欄</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/posts" class="nav__link">所有文章</a>
                      </li>
                      
                      <li class="nav__item">
                        <a href="/contact" class="nav__link">聯絡我</a>
                      </li>
                      
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </nav>
        </div>

        <div class="navigation">
          <div class="top-nav">
            <ul class="nav__list list-reset">
              
              <li class="nav__item">
                <a href="/" class="nav__link">首頁</a>
              </li>
              
              <li class="nav__item">
                <a href="/about" class="nav__link">關於我</a>
              </li>
              
              <li class="nav__item">
                <a href="/tags/project" class="nav__link">個人專案</a>
              </li>
              
              <li class="nav__item">
                <a href="/tags/ithome-%E9%90%B5%E4%BA%BA%E8%B3%BD-2025" class="nav__link">iThome 鐵人賽 2025 專欄</a>
              </li>
              
              <li class="nav__item">
                <a href="/posts" class="nav__link">所有文章</a>
              </li>
              
              <li class="nav__item">
                <a href="/contact" class="nav__link">聯絡我</a>
              </li>
              
            </ul>
          </div>
          <div class="nav-buttons">
            <i class="nav__icon nav__icon-menu ion ion-md-menu"></i>
            <i class="nav__icon nav__icon-search ion ion-md-search"></i>
          </div>
        </div>

      </div>
    </div>
  </div>
</header>



<div class="search">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="search__box">
          <div class="search__group">
            <div class="search__close">
              <i class="ion ion-md-close"></i>
            </div>
            <label for="js-search-input" class="screen-reader-text">搜尋文章</label>
            <input type="text" id="js-search-input" class="search__text" autocomplete="off" placeholder="搜尋文章">
          </div>
          <div id="js-results-container" class="search-results-list" style="display:none;"></div>
        </div>
      </div>
    </div>
  </div>
</div>


  
  <main class="content" aria-label="Content">
    




<div class="container">
  <div class="row">
    <div class="col col-12">
      <div class="image-box">
        <img class="post-image" src="http://twcch.io/images/post/common/data_science_competition_01.png" alt="(Day 2) 線性迴歸 (Linear Regression)">
      </div>
    </div>
  </div>
</div>


<div class="container">

  <div class="row">
    <div class="col col-8 col-d-10 push-2 push-d-1 col-t-12 push-t-0">
    
      
      <article class="post amimate">

        <div class="post__head">
          
          <div class="post__tags">
            
            <a href="http://twcch.io/tags/data-science/" class="post-tags__tag">Data Science</a>
            
            <a href="http://twcch.io/tags/ithome-%E9%90%B5%E4%BA%BA%E8%B3%BD-2025/" class="post-tags__tag">IThome 鐵人賽 2025</a>
            
            <a href="http://twcch.io/tags/30-%E5%A4%A9%E5%85%A5%E9%96%80%E5%B8%B8%E8%A6%8B%E7%9A%84%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%BC%94%E7%AE%97%E6%B3%95/" class="post-tags__tag">30 天入門常見的機器學習演算法</a>
            
          </div>
          

          <h1 class="post__title">(Day 2) 線性迴歸 (Linear Regression)</h1>

          <div class="post__meta">
            <div class="post__author">
              <a href="/about/" class="post__author-image" style="background-image: url('http://twcch.io/images/avatar.jpg')" aria-label="謝志謙's Picture"></a> <a href="/about/" class="post__author-link">謝志謙</a>
            </div>
            <span class="post__date">
              <time datetime=" 2025-07-31T00:00:00&#43;08:00">Jul 31, 2025</time>
            </span>
          </div>

        </div>
    
        <div class="post__content">
          <p>線性迴歸 (Linear Regression) 是統計學中的一種預測方法，主要分為簡單線性迴歸 (Simple Linear Regression) 與多元線性迴歸 (Multiple Linear Regression)，又稱複迴歸，以及其他變形的迴歸等，但在線性迴歸中，通常會有 1~N 個自變數 (Independent Variable) X，也可以稱作特徵 (Feature)；和 1 個因變數 (Dependent Variable) Y，也可以稱作目標 (Target)。而最終目的就是找出一條最佳迴歸線，來擬合這些數據點，便可以用來預測未來的數據點。</p>
<h2 id="模型介紹">模型介紹</h2>
<h3 id="模型邏輯與核心概念">模型邏輯與核心概念</h3>
<h4 id="線性迴歸假設">線性迴歸假設</h4>
<p>統計學線性迴歸的經典的五大假設:</p>
<ul>
<li>線性關係: 自變數與因變數之間存在線性關係</li>
<li>誤差項獨立 (Independence): 誤差項之間沒有相互關係</li>
<li>同標準差性 (Homoscedasticity): 對於所有的自變數，誤差項具有相同的標準差</li>
<li>誤差項常態性 (Normality of Errors): 誤差項應該成常態分佈</li>
<li>高度共線性 (Multicollinearity): 自變數間高度線性相關</li>
</ul>
<p>看到這邊會想說，為什麼要特別註明統計學? 跟機器學習無關? 先記住一句話「統計學重推論，機器學習重預測」，很多假設跟機器學習中的線性迴歸模型還真的沒有太大的關係，但是也不代表，機器學習模型完全沒有假設，但是相對比較不重要，這也是為什麼很多仿間的機器學習教材都會忽略假設這塊。</p>
<p>總而言之，機器學習模型不像統計學模型需要那麼嚴謹的假設，但是若違反某些假設，也是會影響機器學習模型的表現，也會使得模型只能用於預測，無法用於推論，以下簡單整理假設對統計模型與機器學習模型的影響:</p>
<table>
  <thead>
      <tr>
          <th>假設</th>
          <th>對傳統統計模型影響</th>
          <th>對機器學習影響</th>
          <th>建議處理方式</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>線性關係</td>
          <td>✅ 極高 (核心假設)</td>
          <td>❌ 可忽略 (可透過特徵轉換處理)</td>
          <td>用非線性模型 / 特徵轉換</td>
      </tr>
      <tr>
          <td>誤差獨立性</td>
          <td>✅ 高 (推論與解釋需此條件支持)</td>
          <td>✅ 高 (對 generalization 有直接影響)</td>
          <td>使用適當資料分割策略</td>
      </tr>
      <tr>
          <td>同變異性</td>
          <td>✅ 中高 (影響參數估計的信度)</td>
          <td>❌ 可忽略 (模型的估計值仍然準，但 p-value、CI 失真)</td>
          <td>變數轉換、加權最小平方法</td>
      </tr>
      <tr>
          <td>誤差常態性</td>
          <td>✅ 中高 (特定推論工具須常態性支持)</td>
          <td>❌ 可忽略</td>
          <td>若僅做預測可忽略</td>
      </tr>
      <tr>
          <td>共線性</td>
          <td>✅ 高 (嚴重影響模型可解釋性與推論)</td>
          <td>❌ 可忽略 (但建議修正以利解釋)</td>
          <td>VIF、降維、正則化</td>
      </tr>
  </tbody>
</table>
<h4 id="運作原理">運作原理</h4>
<p>我們先回到線性迴歸的用途與目的，簡單來說就是「找出一條最佳直線，來擬合這些數據點，便可以用來預測未來的數據點」，如何找出最佳直線? 本文會簡單的介紹一下，詳細過程與原理，再請讀者自行尋找其他資源暸解。</p>
<ul>
<li>假設方程式: $\hat{y} = \beta_0 + \mathbf{x}^\top \boldsymbol{\beta}$。</li>
<li>統計學模型
<ul>
<li>假設誤差項 $\varepsilon_i$ 滿足期望值為 0、常態分布、同變異等條件。</li>
<li>根據 Gauss-Markov 定理，最小化殘差平方和 (RSS) 可得到 BLUE (最佳線性無偏估計量)，這就是 Ordinary Least Squares (OLS) 方法，使用最小二乘法的封閉解來最小化損失函數，該方法找到使誤差平方和最小的係數。</li>
</ul>
</li>
<li>機器學習模型
<ul>
<li>假設損失函數 (Cost Function): $MSE = \frac{1}{2n} \sum\limits_{i=1}^{n} (y_{i} - \hat{y}_{i})^{2}$。</li>
<li>使用梯度下降 (Batch Gradient Descent) 來最小化損失函數，最符合機器學習的原理，但是通常只用於大數據 (而 sklearn 仍然是透過 OLS 來實現)。</li>
</ul>
</li>
</ul>
<p>所以不論是統計學還是機器學習的線性迴歸模型，就是要找出最佳的迴歸線，只是方式不同而已。</p>
<h4 id="模型評估指標">模型評估指標</h4>
<ul>
<li>R-squared ($R^2$): 衡量解釋能力 (總體績效)</li>
<li>Adjusted R-squared</li>
<li>Mean Squared Error (MSE)</li>
<li>Root Mean Squared Error (RMSE)</li>
<li>Mean Absolute Error (MAE)</li>
<li>Residual Analysis: 檢查模型假設、異常、偏誤</li>
</ul>
<h3 id="適用情境">適用情境</h3>
<p>線性迴歸的適用場景通常滿足以下條件:</p>
<ul>
<li>特徵與標籤之間關係接近線性 (可透過散佈圖觀察)。</li>
<li>預測任務對解釋能力有高度需求 (例如需要明確了解每個變數如何影響結果)。</li>
<li>需求偏向建構基準線 (baseline) 或快速估算。</li>
</ul>
<h3 id="限制條件">限制條件</h3>
<p>線性迴歸雖然簡潔，但在多數真實場景下可能面臨以下困境:</p>
<ul>
<li>資料非線性: 大多數實務資料都包含非線性結構，線性模型難以捕捉 (可以搭配 Polynomial Features 處理)。</li>
<li>高維資料與多重共線性: 特徵太多或高度相關，可能導致不穩定或過擬合。</li>
<li>不具備交互作用建模能力: 無法處理變數之間的聯合影響 (除非顯式創造交互項)。</li>
<li>差異質性與異常值敏感: 若誤差分布異常或出現極端值，模型容易偏誤。</li>
</ul>
<h3 id="與其他模型的比較">與其他模型的比較</h3>
<p>與其他模型相比，線性迴歸具備明確的比較基準:</p>
<table>
  <thead>
      <tr>
          <th>模型</th>
          <th>解釋性</th>
          <th>應變能力</th>
          <th>計算成本</th>
          <th>擬合彈性</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>線性迴歸</td>
          <td>✅ 高</td>
          <td>❌ 低</td>
          <td>✅ 低</td>
          <td>❌ 低</td>
      </tr>
      <tr>
          <td>決策樹 / 隨機森林</td>
          <td>❌ 低</td>
          <td>✅ 高</td>
          <td>❌ 中</td>
          <td>✅ 中</td>
      </tr>
      <tr>
          <td>支持向量機</td>
          <td>❌ 中</td>
          <td>✅ 高</td>
          <td>❌ 高</td>
          <td>✅ 中</td>
      </tr>
      <tr>
          <td>神經網路</td>
          <td>❌ 極低</td>
          <td>✅ 極高</td>
          <td>❌ 極高</td>
          <td>✅ 高</td>
      </tr>
  </tbody>
</table>
<p>(其他模型後續會慢慢介紹 &hellip; )</p>
<p>線性迴歸的最大價值在於它是所有模型的基線模型 (baseline)。若一個任務連線性迴歸都無法擊敗，則其他模型的表現很可能也是不穩定或過擬合的。</p>
<h2 id="模型實作">模型實作</h2>
<h3 id="資料集介紹">資料集介紹</h3>
<p>將使用經典的 Boston Housing Dataset 為例。由於 scikit-learn 已移除該資料集，我們改採自 Carnegie Mellon University 所提供的公開版本。樣本內容如下:</p>
<p><img src="https://github.com/twcch/drive/raw/main/images/Image_2025-08-01_22-34-54.png" alt="Image_2025-08-01_22-34-54.png"></p>
<p>欄位說明:</p>
<ul>
<li>CRIM: 每人平均犯罪率</li>
<li>ZN: 區域住宅用地比例</li>
<li>INDUS: 區域非零售商業用地比例</li>
<li>CHAS: 查爾斯河虛擬變數 (1 = 河流旁, 0 = 其他)</li>
<li>NOX: 一氧化氮濃度 (parts per 10 million)</li>
<li>RM: 每個住宅的平均房間數</li>
<li>AGE: 1940 年之前建造的自用住宅比例</li>
<li>DIS: 到波士頓五個中心區域的加權距離</li>
<li>RAD: 公路接近指數 (1 = 最接近, 24 = 最遠)</li>
<li>TAX: 每 $10,000 的財產稅率</li>
<li>PTRATIO: 學生與教師比例</li>
<li>B: 1000(Bk - 0.63)^2, Bk = 區域黑人比例</li>
<li>LSTAT: 區域人口中低收入者的比例</li>
<li>MEDV: 自用住宅的中位數價格 (單位: $1000s)</li>
</ul>
<h3 id="程式實例">程式實例</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_boston_housing_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://lib.stat.cmu.edu/datasets/boston&#34;</span>  <span class="c1"># Boston Housing Dataset from Carnegie Mellon University</span>
</span></span><span class="line"><span class="cl">    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">22</span><span class="p">:]</span>  <span class="c1"># 從第 23 行開始</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># 每筆資料分為 2 行 → 共 506 筆 → 總共 1012 行</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line_1</span> <span class="o">+</span> <span class="n">line_2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;CRIM&#34;</span><span class="p">,</span>  <span class="c1"># 每人平均犯罪率</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ZN&#34;</span><span class="p">,</span>  <span class="c1"># 區域住宅用地比例</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;INDUS&#34;</span><span class="p">,</span>  <span class="c1"># 區域非零售商業用地比例</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;CHAS&#34;</span><span class="p">,</span>  <span class="c1"># 查爾斯河虛擬變數 (1 = 河流旁, 0 = 其他)</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;NOX&#34;</span><span class="p">,</span>  <span class="c1"># 一氧化氮濃度 (parts per 10 million)</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;RM&#34;</span><span class="p">,</span>  <span class="c1"># 每個住宅的平均房間數</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;AGE&#34;</span><span class="p">,</span>  <span class="c1"># 1940 年之前建造的自用住宅比例</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;DIS&#34;</span><span class="p">,</span>  <span class="c1"># 到波士頓五個中心區域的加權距離</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;RAD&#34;</span><span class="p">,</span>  <span class="c1"># 公路接近指數 (1 = 最接近, 24 = 最遠)</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;TAX&#34;</span><span class="p">,</span>  <span class="c1"># 每 $10,000 的財產稅率</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;PTRATIO&#34;</span><span class="p">,</span>  <span class="c1"># 學生與教師比例</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;B&#34;</span><span class="p">,</span>  <span class="c1"># 1000(Bk - 0.63)^2, Bk = 區域黑人比例</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;LSTAT&#34;</span><span class="p">,</span>  <span class="c1"># 區域人口中低收入者的比例</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;MEDV&#34;</span><span class="p">,</span>  <span class="c1"># 自用住宅的中位數價格 (單位: $1000s)</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">df</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ----- 讀取資料 -----</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">original_data</span> <span class="o">=</span> <span class="n">get_boston_housing_data</span><span class="p">()</span>  <span class="c1"># 讀取資料</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ----- 資料前處理 -----</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">cleaned_data</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">## 因透過 print(cleaned_data.isnull().sum()) 檢查缺失值 (0 筆)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">## 且 Pearson 相關係數檢查，相關係數 &gt;= 0.8 (0 筆)    </span>
</span></span><span class="line"><span class="cl">    <span class="c1">### correlation_matrix = cleaned_data.corr()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">### target_corr = correlation_matrix[&#39;MEDV&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="c1">### high_corr_features = target_corr[target_corr &gt; 0.8].drop(&#39;MEDV&#39;)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">### print(f&#34;與 target 高度正相關的欄位:&#34;, high_corr_features)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">## 故不做資料前處理</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ----- 模型訓練 -----</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">## 資料分割</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="n">cleaned_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;MEDV&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="n">cleaned_data</span><span class="p">[</span><span class="s2">&#34;MEDV&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">## 建立模型</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="s2">&#34;lr&#34;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">## 預測</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">## 評估</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;train data 均方誤差 (MSE): </span><span class="si">{</span><span class="n">train_mse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;train data 決定係數 R²: </span><span class="si">{</span><span class="n">train_r2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">test_mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;test data 均方誤差 (MSE): </span><span class="si">{</span><span class="n">test_mse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;test data 決定係數 R²: </span><span class="si">{</span><span class="n">test_r2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="執行結果">執行結果</h3>
<ul>
<li>train data 均方誤差 (MSE): 21.6414</li>
<li>train data 決定係數 R²: 0.7509</li>
<li>test data 均方誤差 (MSE): 24.2911</li>
<li>test data 決定係數 R²: 0.6688</li>
</ul>
<h4 id="結果評估">結果評估</h4>
<p>進行執行結果評估前，先來回顧評估指標的含義:</p>
<table>
  <thead>
      <tr>
          <th>指標</th>
          <th>意義</th>
          <th>解釋方式</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MSE (Mean Squared Error)</td>
          <td>預測值與實際值之間的平方差平均值</td>
          <td>越小越好，越接近 0 表示預測誤差越小</td>
      </tr>
      <tr>
          <td>R² (決定係數)</td>
          <td>模型能解釋的變異比例 (總變異中有多少被模型解釋)</td>
          <td>越接近 1 越好；0 表示無解釋力；&lt;0 表示比常數預測還差</td>
      </tr>
  </tbody>
</table>
<p>接下來看一下訓練資料與測試資料的表現:</p>
<ul>
<li>訓練資料 (Train Data) 的表現
<ul>
<li>R² = 0.7509: 表示模型可以解釋訓練資料中 約 75% 的變異</li>
<li>MSE = 21.64: 對應房價誤差約為 $\sqrt{21.64} \approx 4.65$ 千美元 ($4,650)</li>
</ul>
</li>
<li>測試資料 (Test Data) 表現
<ul>
<li>R² = 0.6688: 模型在未見過的資料上仍解釋了 約 66.9% 的變異</li>
<li>MSE = 24.29: 誤差略升，對應 RMSE 約 $\sqrt{24.29} \approx 4.93$ 千美元</li>
</ul>
</li>
</ul>
<p>以上的結果表現，都相當合理，表示模型在訓練資料上有不錯的擬合力，沒有明顯欠擬合 (underfitting)，測試資料預測略為劣化，但整體表現尚稱穩定，總結如下:</p>
<table>
  <thead>
      <tr>
          <th>指標</th>
          <th>判斷</th>
          <th>解釋</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Train R² 明顯 &gt; Test R²</td>
          <td>輕微的 overfitting 傾向</td>
          <td>差距不大，可接受</td>
      </tr>
      <tr>
          <td>MSE 增加幅度有限 (+2.65)</td>
          <td>模型泛化能力尚可</td>
          <td>尚無高變異問題</td>
      </tr>
  </tbody>
</table>
<h4 id="下一步建議">下一步建議</h4>
<table>
  <thead>
      <tr>
          <th>方向</th>
          <th>建議方法</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>增強模型</td>
          <td>使用 PolynomialFeatures 擴展非線性項</td>
      </tr>
      <tr>
          <td>加強泛化能力</td>
          <td>使用 Ridge 或 Lasso 進行正則化</td>
      </tr>
      <tr>
          <td>改用非線性模型</td>
          <td>嘗試 RandomForestRegressor、XGBoostRegressor</td>
      </tr>
      <tr>
          <td>模型比較</td>
          <td>建立 baseline vs 進階模型比較報告 (MSE / R² / 殘差圖)</td>
      </tr>
      <tr>
          <td>誤差分析</td>
          <td>畫出 Residual Plot 檢查異常值與變異不一致性 (heteroscedasticity)</td>
      </tr>
  </tbody>
</table>
<h2 id="結語">結語</h2>
<p>線性迴歸的價值不在於它能解決所有問題，而在於它讓我們對「資料與結果的關係」建立第一個清晰的架構。這種清晰，是日後面對複雜資料時，所有模型選擇的比較基準。當你真正理解一個模型的假設、信念、行為邏輯與表現訊號時，你不再是依賴工具，而是在與資料進行對話。</p>
<h2 id="備註">備註</h2>
<ul>
<li>同步發表於 iThome 鐵人賽 2025 - 30 天入門常見的機器學習演算法</li>
</ul>

        </div>
    
        <div class="post__share">
  <div class="share__head">
    <div class="share__title">Share this article</div>
  </div>
  <ul class="share__list list-reset">
    <li class="share__item">
      <a class="share__link share__facebook" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2ftwcch.io%2fposts%2fironman_2025%2farticles_25073101%2f"
        onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
        title="Share on Facebook" rel="nofollow"><i class="ion ion-logo-facebook"></i></a>
    </li>
    <li class="share__item">
      <a class="share__link share__twitter" href="https://twitter.com/intent/tweet?text=%28Day%202%29%20%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%20%28Linear%20Regression%29&url=http%3a%2f%2ftwcch.io%2fposts%2fironman_2025%2farticles_25073101%2f" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" rel="nofollow"><i class="ion ion-logo-twitter"></i></a>
    </li>

    <li class="share__item">
      <a class="share__link share__linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2ftwcch.io%2fposts%2fironman_2025%2farticles_25073101%2f&title=%28Day%202%29%20%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%20%28Linear%20Regression%29&summary=&source=%28Day%202%29%20%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%20%28Linear%20Regression%29"
      onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" rel="nofollow"><i class="ion ion-logo-linkedin"></i></a>
    </li>

    <li class="share__item">
      <a class="share__link share__pinterest"
        href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2ftwcch.io%2fposts%2fironman_2025%2farticles_25073101%2f&amp;media=http%3a%2f%2ftwcch.io%2fimages%2fpost%2fcommon%2fdata_science_competition_01.png&amp;description=%28Day%202%29%20%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%20%28Linear%20Regression%29"
        onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
        title="Share on Pinterest" aria-label="Share on Pinterest"><i class="ion ion-logo-pinterest"></i></a>
    </li>
  </ul>
</div>

        
        <div class="post__navigation">
          
          <a class="prev" href="http://twcch.io/posts/ironman_2025/articles_25073001/" style="background-image: url('./images/post/common/data_science_competition_01.png')">
            <div class="post__nav-box">
              <div class="post__nav post__nav__prev"><i class="ion ion-ios-arrow-back"></i> Previous
                Page</div>
              <h4 class="post__nav__title">(Day 1) 介紹與準備</h4>
            </div>
          </a>
          
          
          <a class="next" href="http://twcch.io/posts/ironman_2025/articles_25080101/" style="background-image: url('./images/post/common/data_science_competition_01.png')">
            <div class="post__nav-box">
              <div class="post__nav post__nav__next">Next Page <i class="ion ion-ios-arrow-forward"></i></div>
              <h4 class="post__nav__title">(Day 3) 多項式迴歸 (Polynomial Regression)</h4>
            </div>
          </a>
          
        </div>
        

        
          
<div id="disqus_thread" class="post__comments">
  <div id="disqus_empty"></div>
</div>

<script>
  function load_disqus() {
    var disqus_shortname = 'anvod-studio-aditu',
      is_disqus_empty = document.getElementById('disqus_empty'),
      disqus_target = document.getElementById('disqus_thread'),
      disqus_embed = document.createElement('script'),
      disqus_hook = (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]);

    if (disqus_target && is_disqus_empty) {
      disqus_embed.type = 'text/javascript';
      disqus_embed.async = true;
      disqus_embed.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      disqus_hook.appendChild(disqus_embed);
      is_disqus_empty.remove();
    }
  }

  window.addEventListener('scroll', function (e) {
    var currentScroll = document.scrollingElement.scrollTop;
    var disqus_target = document.getElementById('disqus_thread');

    if (disqus_target && (currentScroll > disqus_target.getBoundingClientRect().top - 150)) {
      load_disqus('disqus_shortname');
    }
  }, false);

</script>
<noscript>Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>

        
    
      </article>
      
    </div>
  </div>


</div>




  </main>
  

  <div class="top" title="Top"><i class="ion ion-ios-arrow-up"></i></div>

  




<footer class="footer">

  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="footer__inner">
          

<div class="social">
  <ul class="social__list list-reset">
    
    <li class="social__item">
      <a class="social__link" href="https://github.com/twcch" target="_blank" rel="noopener"
        aria-label="Github link"><i class="ion ion-logo-github"></i></a>
    </li>
    
  </ul>
</div>


          <div class="copyright">
            &copy; 2020–2025 <a href="/">志謙&#39;s Blog</a>.
             
          </div>
        </div>
      </div>
    </div>
  </div>

</footer>


  


<script src="/js/scripts.min.0a3f16199071420ff4ff1b00d3a17a82da5457f6cc2e1911abcf6af3455175e1.js"></script>
<script src="/js/common.min.97bf160adbcbe9b0d5bd37c5aa39cb5f1f3a88050b81463847425ffb0387d33e.js"></script>

</body>

</html>